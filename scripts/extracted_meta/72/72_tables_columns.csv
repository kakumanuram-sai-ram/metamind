tables_involved,column_names,alias_column_name,source_or_derived,derived_column_logic,column_datatype,extra,comment
hive.team_cst_mhd_product.soundbox_eval_completed,active_sessions,Active Sessions,derived,sum(active_sessions),bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,active_sessions,Agent Handover %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE SUM(ah_tickets) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,active_sessions,Analyzed %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE SUM(analyzed_sessions) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,active_sessions,Feedback Rate %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE (SUM(happy) + SUM(sad)) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,active_sessions,Service Ticket %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE SUM(service_tickets) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,active_sessions,active_sessions,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,ah_tickets,Agent Tickets,derived,SUM(ah_tickets),bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,ah_tickets,ah_tickets,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,analyzed_sessions,Analyzed %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE SUM(analyzed_sessions) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,analyzed_sessions,Analyzed Sessions,derived,sum(analyzed_sessions),bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,analyzed_sessions,Eval Completed %,derived,CASE WHEN SUM(analyzed_sessions) = 0 THEN NULL ELSE SUM(eval_completed) * 100 / SUM(analyzed_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,analyzed_sessions,analyzed_sessions,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,cst_entity,cst_entity,source,,varchar,,
hive.team_cst_mhd_product.soundbox_eval_completed,date_,date_,source,,date,,
hive.team_cst_mhd_product.soundbox_eval_completed,date_,date___,derived,"date_trunc('day', CAST(date_ AS TIMESTAMP))",date,,
hive.team_cst_mhd_product.soundbox_eval_completed,eval_completed,Eval Completed,derived,sum(eval_completed),bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,eval_completed,Eval Completed %,derived,CASE WHEN SUM(analyzed_sessions) = 0 THEN NULL ELSE SUM(eval_completed) * 100 / SUM(analyzed_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,eval_completed,eval_completed,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,fd_tickets,fd_tickets,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,fd_tickets_og,fd_tickets_og,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,happy,Happy Feedback,derived,sum(happy),bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,happy,happy,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,hour_timestamp,hour_timestamp,source,,timestamp(3),,
hive.team_cst_mhd_product.soundbox_eval_completed,sad,Sad Feedback,derived,sum(sad),bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,sad,sad,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,service_tickets,Service Tickets,derived,SUM(service_tickets),bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,service_tickets,service_tickets,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_completed,total_sessions,total_sessions,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,active_sessions,Bot Containment %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE (SUM(active_sessions) - SUM(fd_tickets)) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,active_sessions,active_sessions,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,agent_response_repetition,Bot Repetition %,derived,CASE WHEN SUM(eval_completed) = 0 THEN NULL ELSE SUM(agent_response_repetition) * 100.0 / SUM(eval_completed) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,agent_response_repetition,agent_response_repetition,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_empathy_score,Avg Empathy Score,derived,AVG(avg_empathy_score) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_empathy_score,avg_empathy_score,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_eval_score,AVG Eval Score %,derived,(AVG(avg_eval_score)) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_eval_score,avg_eval_score,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_resolution_achieved,Avg Resolution Achieved,derived,AVG(avg_resolution_achieved) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_resolution_achieved,avg_resolution_achieved,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_response_relevance_score,Avg Response Relevance,derived,AVG(avg_response_relevance_score) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,avg_response_relevance_score,avg_response_relevance_score,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,cst_entity,cst_entity,source,,varchar,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,date_,date_,source,,date,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,eval_completed,eval_completed,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,eval_score_bad,Bad Eval Share %,derived,CASE WHEN (SUM(eval_score_good) + SUM(eval_score_bad)) = 0 THEN NULL ELSE SUM(eval_score_bad) * 100 / (SUM(eval_score_good) + SUM(eval_score_bad)) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,eval_score_bad,eval_score_bad,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,eval_score_good,eval_score_good,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,fd_tickets,fd_tickets,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,function_call_failed,Bot Failed %,derived,CASE WHEN SUM(eval_completed) = 0 THEN NULL ELSE SUM(function_call_failed) * 100.0 / SUM(eval_completed) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,function_call_failed,function_call_failed,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,happy,MSAT %,derived,CASE WHEN (SUM(sad)+SUM(happy)) = 0 THEN NULL ELSE SUM(happy) * 100 /(SUM(sad)+SUM(happy)) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,happy,happy,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,hour_timestamp,hour_timestamp,source,,timestamp(3),,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,intent_incoherence_count,Intent Detection Failed %,derived,CASE WHEN SUM(eval_completed) = 0 THEN NULL ELSE SUM(intent_incoherence_count) * 100.0 / SUM(eval_completed) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,intent_incoherence_count,intent_incoherence_count,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,negative_user_sentiment,Negative Change #,derived,sum(negative_user_sentiment),bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,negative_user_sentiment,Negative Change %,derived,"CASE WHEN (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment)) = 0 THEN NULL
ELSE
SUM(negative_user_sentiment) * 100 / (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment))
END",bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,negative_user_sentiment,negative_user_sentiment,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,neutral_user_sentiment,Neutral Change #,derived,sum(neutral_user_sentiment),bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,neutral_user_sentiment,Neutral Change %,derived,"CASE WHEN (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment)) = 0 THEN NULL
ELSE
SUM(neutral_user_sentiment) * 100 / (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment))
END",bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,neutral_user_sentiment,neutral_user_sentiment,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,positive_user_sentiment,Positive Change #,derived,sum(positive_user_sentiment),bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,positive_user_sentiment,Positive Change %,derived,"CASE WHEN (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment)) = 0 THEN NULL
ELSE
SUM(positive_user_sentiment) * 100 / (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment))
END",bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,positive_user_sentiment,positive_user_sentiment,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_l1_summary1,sad,sad,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,active_sessions,Active Sessions,derived,sum(active_sessions),bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,active_sessions,active_sessions,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,agent_response_repetition,Bot Repetition %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE SUM(agent_response_repetition) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,agent_response_repetition,agent_response_repetition,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_empathy_score,AVG Empathy Score,derived,AVG(avg_empathy_score) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_empathy_score,avg_empathy_score,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_eval_score,AVG Eval Score,derived,AVG(avg_eval_score) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_eval_score,avg_eval_score,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_resolution_achieved,AVG Resolution Achieved,derived,AVG(avg_resolution_achieved) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_resolution_achieved,avg_resolution_achieved,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_response_relevance_score,AVG Response Relevance,derived,AVG(avg_response_relevance_score) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_response_relevance_score,avg_response_relevance_score,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_topic_drift,AVG Topic Drift,derived,AVG(avg_topic_drift) * 100,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,avg_topic_drift,avg_topic_drift,source,,double,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,cst_entity,cst_entity,source,,varchar,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,date_,date_,source,,date,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,eval_completed,Eval Completed %,derived,SUM(eval_completed) * 100/ SUM(active_sessions),bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,eval_completed,eval_completed,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,eval_score_bad,Bad Eval Share %,derived,CASE WHEN (SUM(eval_score_good) + SUM(eval_score_bad)) = 0 THEN NULL ELSE SUM(eval_score_bad) * 100 / (SUM(eval_score_good) + SUM(eval_score_bad)) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,eval_score_bad,eval_score_bad,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,eval_score_good,eval_score_good,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,function_call_failed,Bot Failed %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE SUM(function_call_failed) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,function_call_failed,function_call_failed,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,happy,MSAT %,derived,CASE WHEN (SUM(happy) + SUM(sad)) = 0 THEN NULL ELSE (SUM(happy) * 100.0) / (SUM(happy) + SUM(sad)) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,happy,happy,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,intent_incoherence_count,Intent Detection Failed %,derived,CASE WHEN SUM(active_sessions) = 0 THEN NULL ELSE SUM(intent_incoherence_count) * 100 / SUM(active_sessions) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,intent_incoherence_count,intent_incoherence_count,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,negative_user_sentiment,negative_user_sentiment,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,neutral_user_sentiment,neutral_user_sentiment,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,out_key_problem_desc,out_key_problem_desc,source,,varchar,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,positive_user_sentiment,+ve Sentiment Change %,derived,CASE WHEN (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment)) = 0 THEN NULL ELSE SUM(positive_user_sentiment) * 100 / (SUM(positive_user_sentiment)+SUM(negative_user_sentiment)+SUM(neutral_user_sentiment)) END,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,positive_user_sentiment,positive_user_sentiment,source,,bigint,,
hive.team_cst_mhd_product.soundbox_eval_llm_l1,sad,sad,source,,bigint,,
