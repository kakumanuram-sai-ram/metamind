{
  "dashboard_id": 585,
  "dashboard_title": "3P Online Top 1000 Merchant Summary",
  "dashboard_url": "https://cdp-dataview.platform.mypaytm.com/superset/dashboard/585/",
  "owner": "Unknown",
  "created_on": "",
  "changed_on": "2025-11-21T11:08:26.439910",
  "charts": [
    {
      "chart_id": 3157,
      "chart_name": "3P online top 1k Daily Summary",
      "chart_type": "table",
      "dataset_id": 1328,
      "dataset_name": "3P_online_top_1k_agg_summary",
      "database_name": "Trino",
      "sql_query": "SELECT online_merchant_name AS online_merchant_name, sum(\"7d_avg_DAU\") AS \"7d avg DAU\", sum(\"Yday_DAU\") AS \"Yday DAU\", AVG(Yday_DAU)/AVG(\"7d_avg_DAU\") - 1 AS \"Yday DAU Growth\", sum(\"LMTD_mau\") AS \"LMTD MAU\", sum(\"MTD_mau\") AS \"MTD MAU\", AVG(MTD_mau)/AVG(LMTD_mau) - 1 AS \"MTD MAU Growth\", sum(\"Yday_txns\") AS \"yday txns\", sum(\"7d_avg_txns\") AS \"7d avg Txns\", avg(Yday_txns)/avg(\"7d_avg_txns\") - 1 AS \"Yday Txn Growth\", sum(\"LMTD_txns\") AS \"LMTD Txns\", sum(\"MTD_txns\") AS \"MTD Txns\", avg(MTD_txns)/avg(LMTD_txns)-1 AS \"MTD Txn _Growth\", sum(\"7d_avg_gmv\") AS \"7d avg Gmv\", sum(\"Yday_gmv\") AS \"yday Gmv\", avg(Yday_gmv)/avg(\"7d_avg_gmv\") - 1 AS \"Yday Gmv Growth\", sum(\"LMTD_gmv\") AS \"LMTD Gmv\", sum(\"MTD_gmv\") AS \"MTD GMV\", avg(MTD_gmv)/avg(LMTD_gmv) -1 AS \"MTD Gmv Growth\", sum(\"7d_avg_nr\") AS \"7d avg NR\", sum(\"Yday_nr\") AS \"Yday NR\", avg(yday_nr)/avg(\"7d_avg_nr\")- 1 AS \"Yday NR Growth\", sum(\"LMTD_nr\") AS \"LMTD NR\", sum(\"MTD_nr\") AS \"MTD NR\", avg(MTD_nr)/avg(LMTD_nr) - 1 AS \"MTD NR Grwoth\" \nFROM (with A as(\nSELECT * FROM (\nSELECT day_id AS day_id, online_merchant_name AS online_merchant_name, dau AS dau, mau AS mau, \"NR\" AS \"NR\", new AS new, \"React\" AS \"React\", n_txns AS n_txns, gmv AS gmv \nFROM (with upi_flow_wise_base as (\nselect a.*, b.online_merchant_name, date_trunc('month',day_id) mnt,\ncase when day_id between date_trunc('month',current_date - interval '01' day) and current_date - interval '01' day then 'MTD'\nwhen day_id between date_trunc('month',current_date - interval '01' day - interval '01' month) and current_date - interval '01' day - interval '01' month then 'LMTD'\nend as periods,\n--row_number() over (partition by payer_cust_id,b.online_merchant_name, date_trunc('month', date(cast(txn_timestamp as timestamp ))) order by txn_timestamp) as rn_online_merchant_name\nrow_number() over (partition by customer_id, date_trunc('month', date(day_id)) order by created_on) as rn_ft\nfrom (\nselect\ntransaction_date_key day_id,\ncustomer_id_payer customer_id,\ntxn_timestamp created_on,\ntxn_id,\namount,\npayee_vpa,\nCASE                        \n        WHEN flow_category IN ('P2P') THEN 'P2P'\n        WHEN flow_category IN ('3P QR', 'Paytm QR') THEN 'SnP'\n        WHEN flow_category IN ('Intent', 'P2M Collect','Mandate_Online') THEN 'Online'\n        WHEN flow_category IN ('Onus_ExcMandates','Mandate_Onus') THEN 'Onus'\n        ELSE 'Others' \nEND AS final_category\n\nfrom  cdo.fact_upi_transactions_snapshot_v3\nwhere dl_last_updated >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)\nand transaction_type in('PAY','COLLECT')\nand category in ('VPA2ACCOUNT','VPA2VPA','VPA2MERCHANT')\nand status = 'SUCCESS'\nand lower(payer_handle) in ('paytm','ptyes','ptaxis','pthdfc','ptsbi')\n\n)a\nleft JOIN  user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on LOWER(a.payee_vpa) = LOWER(b.payee_vpa)\n),\n\npaytm_nrr AS (\n      SELECT customer_id customer_id, date_trunc('month',date(txn_date) ) mnt, txn_date day_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type\n      FROM  user_paytm_payments.rolling_nrr_v1 \n      WHERE txn_date >= date'2025-08-01'\n      and user_type not IN ('Repeat')\n       and\n        customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt >=  date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n        and channel in (\n        'fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ) \n        union all\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt >=  date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n        and channel in (\n        'fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong') \n        )\n      )\n\n-- select day_id,txn_id,customer_id,online_merchant_name,amount,rn_ft,mnt,\n-- row_number() over (partition by customer_id,online_merchant_name, date_trunc('month', day_id) order by day_id) as rn_mau\n-- from  upi_flow_wise_base \n--                 where \n--                 -- lower(online_merchant_name) in (select lower(online_merchant_name) from user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss)\n--                 -- and\n--                 final_category = 'Online'\n\n-- and day_id >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)      \n\nselect\na.day_id,\nonline_merchant_name,\n        count(distinct a.customer_id) as dau,\n        count(distinct case when a.rn_mau = 1 then a.customer_id end) as mau,\n        count(distinct case when a.rn_ft = 1 and b.customer_id is not null then a.customer_id  end) as NR, --- paytm new/react \n        count(distinct case when a.rn_ft = 1 and b.user_type = 'New' then a.customer_id  end) as new, --- paytm new/react \n        count(distinct case when a.rn_ft = 1 and  b.user_type = 'React_2M+' then a.customer_id  end) as React, --- paytm new/react \n        count(distinct a.txn_id) as n_txns,\n        sum(cast (amount as double)) as gmv\n\nfrom\n(  \nselect day_id,txn_id,customer_id,online_merchant_name,amount,rn_ft,mnt,\nrow_number() over (partition by customer_id,online_merchant_name, date_trunc('month', day_id) order by day_id) as rn_mau\nfrom  upi_flow_wise_base \n                where lower(online_merchant_name) in (select lower(online_merchant_name) from user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss)\n                and final_category = 'Online'\n\nand day_id >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n)a\nleft join paytm_nrr b on a.customer_id = b.customer_id  and a.mnt = b.mnt\ngroup by 1,2\n\nUNION ALL\n\nselect \n        a.day_id,\n        'overall' as online_merchant_name,\n        count(distinct a.customer_id) as dau,\n        count(distinct case when rn_mau = 1 then a.customer_id end) as mau,\n        count(distinct case when rn_ft = 1 and b.customer_id is not null then a.customer_id  end) as NR, --- paytm new/react\n        count(distinct case when a.rn_ft = 1 and b.user_type = 'New' then a.customer_id  end) as new, --- paytm new/react \n        count(distinct case when a.rn_ft = 1 and  b.user_type = 'React_2M+' then a.customer_id  end) as React, --- paytm new/react \n \n        count(distinct txn_id) as n_txns,\n        sum(cast (amount as double)) as gmv\nfrom\n      (  \nselect day_id,txn_id,customer_id,online_merchant_name,amount,rn_ft,mnt,\nrow_number() over (partition by customer_id, date_trunc('month', day_id) order by day_id) as rn_mau\nfrom  upi_flow_wise_base \n                where final_category = 'Online'\nand day_id >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n)a\nleft join paytm_nrr b on a.customer_id = b.customer_id and a.day_id = b.day_id\ngroup by 1,2\n) AS virtual_table\n) AS dataset_970\n)\n\n,Date_ as(\nSELECT date_column\nFROM UNNEST(\n    SEQUENCE(\n        date_trunc('month', current_date - interval '1' month),\n        current_date - interval '1' day,\n        interval '1' day\n    )\n) AS t(date_column)\n)\n\n\n\n,date_a as (\nselect \ndate_column,\ncase \nwhen date_column between date_trunc('month',current_date  - interval '01' day) and (current_date  - interval '01' day) then 'MTD'\nwhen date_column between date_trunc('month',current_date  - interval '01' day - interval '01' month ) and (current_date  - interval '01' day - interval '01' month ) then 'LMTD'\nend as MTD_Flag,\ncase when date_column = (current_date  - interval '01' day) then 'Yesterday'\nwhen date_column between (current_date  - interval '08' day) and (current_date  - interval '02' day) then 'last_7_day'\nend as yday_flag from date_\n)\n\nselect\nonline_merchant_name,\nsum(dau) filter(where yday_flag = 'Yesterday') Yday_DAU,\nsum(nr) filter(where yday_flag = 'Yesterday') Yday_nr,\nsum(new) filter(where yday_flag = 'Yesterday') Yday_new,\nsum(react) filter(where yday_flag = 'Yesterday') Yday_react,\nsum(n_txns) filter(where yday_flag = 'Yesterday') Yday_txns,\nsum(gmv) filter(where yday_flag = 'Yesterday') Yday_gmv,\n\navg(dau) filter(where yday_flag = 'last_7_day') \"7d_avg_DAU\",\navg(nr) filter(where yday_flag = 'last_7_day') \"7d_avg_nr\",\navg(new) filter(where yday_flag = 'last_7_day') \"7d_avg_new\",\navg(react) filter(where yday_flag = 'last_7_day') \"7d_avg_react\",\navg(n_txns) filter(where yday_flag = 'last_7_day') \"7d_avg_txns\",\navg(gmv) filter(where yday_flag = 'last_7_day') \"7d_avg_gmv\",\n\nsum(mau) filter(where MTD_Flag = 'LMTD') LMTD_mau,\nsum(nr) filter(where MTD_Flag = 'LMTD') LMTD_nr,\nsum(new) filter(where MTD_Flag = 'LMTD') LMTD_new,\nsum(react) filter(where MTD_Flag = 'LMTD') LMTD_react,\nsum(n_txns) filter(where MTD_Flag = 'LMTD') LMTD_txns,\nsum(gmv) filter(where MTD_Flag = 'LMTD') LMTD_gmv,\n----\nsum(mau) filter(where MTD_Flag = 'MTD') MTD_mau,\nsum(nr) filter(where MTD_Flag = 'MTD') MTD_nr,\nsum(new) filter(where MTD_Flag = 'MTD') MTD_new,\nsum(react) filter(where MTD_Flag = 'MTD') MTD_react,\nsum(n_txns) filter(where MTD_Flag = 'MTD') MTD_txns,\nsum(gmv) filter(where MTD_Flag = 'MTD') MTD_gmv\n--max(day_id) data_as_of\n\nfrom A a join date_a b on a.day_id in(b.date_column)\nwhere MTD_Flag is not null or yday_flag is not null\nGROUP by 1\norder by MTD_txns desc\n) AS virtual_table GROUP BY online_merchant_name ORDER BY \"7d avg DAU\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_DAU",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29039,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg DAU",
          "optionName": "metric_mmc77phdm9_w0v2ur3iw0f",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_DAU",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29033,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Yday DAU",
          "optionName": "metric_vg7su0hv4sj_555h5vqdhp3",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday DAU Growth",
          "optionName": "metric_3nd22o7mz1b_qa34ht686oh",
          "sqlExpression": "AVG(Yday_DAU)/AVG(\"7d_avg_DAU\") - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_mau",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29045,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD MAU",
          "optionName": "metric_3zudxo2gn9b_nmcy2aiosr",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_mau",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29051,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD MAU",
          "optionName": "metric_yi2d82qy8cq_98xmoa3x9v6",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD MAU Growth",
          "optionName": "metric_1yyono6nr6a_f77kutc46q",
          "sqlExpression": "AVG(MTD_mau)/AVG(LMTD_mau) - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29037,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "yday txns",
          "optionName": "metric_lijmt5b5a1p_qpr5i2vfxx",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29043,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg Txns",
          "optionName": "metric_iq0fci6k1ts_1pz0mmnty23",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday Txn Growth",
          "optionName": "metric_s7clrjizfj_969vjbggsqa",
          "sqlExpression": "avg(Yday_txns)/avg(\"7d_avg_txns\") - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29049,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Txns",
          "optionName": "metric_s6xbe9surf_rxoh8e8gxwi",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29055,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Txns",
          "optionName": "metric_0ds85p3f4nqr_ih9dvwnked",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Txn _Growth",
          "optionName": "metric_99o6jna8ptl_8w0v044oqt",
          "sqlExpression": "avg(MTD_txns)/avg(LMTD_txns)-1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29044,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg Gmv",
          "optionName": "metric_hmwxe4ss019_qhdui9hukv",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29038,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "yday Gmv",
          "optionName": "metric_paowi30he5f_ccnwof5iqci",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday Gmv Growth",
          "optionName": "metric_vdeqm6mc1kj_tvonee5792",
          "sqlExpression": "avg(Yday_gmv)/avg(\"7d_avg_gmv\") - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29050,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Gmv",
          "optionName": "metric_5bm1v45odp_3h5x99qkpmf",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29056,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD GMV",
          "optionName": "metric_ehwmyfgqsdo_8h41fzrhpbv",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Gmv Growth",
          "optionName": "metric_6pg55sfa739_oprs9qf0v7",
          "sqlExpression": "avg(MTD_gmv)/avg(LMTD_gmv) -1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29040,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg NR",
          "optionName": "metric_5nflc5zxj5v_ww19yw93c3",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29034,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Yday NR",
          "optionName": "metric_2buommkriop_wcoo7mx1n4q",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday NR Growth",
          "optionName": "metric_83imv4uahbj_l6xjsssfdph",
          "sqlExpression": "avg(yday_nr)/avg(\"7d_avg_nr\")- 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29046,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD NR",
          "optionName": "metric_sq4kmfxsblf_y484p865nwf",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29052,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD NR",
          "optionName": "metric_6h5tmrh9iq8_hr02kogp8q8",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD NR Grwoth",
          "optionName": "metric_1ei0jqk5enm_0w3d14qovji",
          "sqlExpression": "avg(MTD_nr)/avg(LMTD_nr) - 1"
        }
      ],
      "columns": [
        "online_merchant_name",
        "Yday_DAU",
        "Yday_nr",
        "Yday_new",
        "Yday_react",
        "Yday_txns",
        "Yday_gmv",
        "7d_avg_DAU",
        "7d_avg_nr",
        "7d_avg_new",
        "7d_avg_react",
        "7d_avg_txns",
        "7d_avg_gmv",
        "LMTD_mau",
        "LMTD_nr",
        "LMTD_new",
        "LMTD_react",
        "LMTD_txns",
        "LMTD_gmv",
        "MTD_mau",
        "MTD_nr",
        "MTD_new",
        "MTD_react",
        "MTD_txns",
        "MTD_gmv"
      ],
      "groupby_columns": [
        "online_merchant_name"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 3157,
      "chart_name": "3P online top 1k Daily Summary",
      "chart_type": "table",
      "dataset_id": 1328,
      "dataset_name": "3P_online_top_1k_agg_summary",
      "database_name": "Trino",
      "sql_query": "SELECT online_merchant_name AS online_merchant_name, sum(\"7d_avg_DAU\") AS \"7d avg DAU\", sum(\"Yday_DAU\") AS \"Yday DAU\", AVG(Yday_DAU)/AVG(\"7d_avg_DAU\") - 1 AS \"Yday DAU Growth\", sum(\"LMTD_mau\") AS \"LMTD MAU\", sum(\"MTD_mau\") AS \"MTD MAU\", AVG(MTD_mau)/AVG(LMTD_mau) - 1 AS \"MTD MAU Growth\", sum(\"Yday_txns\") AS \"yday txns\", sum(\"7d_avg_txns\") AS \"7d avg Txns\", avg(Yday_txns)/avg(\"7d_avg_txns\") - 1 AS \"Yday Txn Growth\", sum(\"LMTD_txns\") AS \"LMTD Txns\", sum(\"MTD_txns\") AS \"MTD Txns\", avg(MTD_txns)/avg(LMTD_txns)-1 AS \"MTD Txn _Growth\", sum(\"7d_avg_gmv\") AS \"7d avg Gmv\", sum(\"Yday_gmv\") AS \"yday Gmv\", avg(Yday_gmv)/avg(\"7d_avg_gmv\") - 1 AS \"Yday Gmv Growth\", sum(\"LMTD_gmv\") AS \"LMTD Gmv\", sum(\"MTD_gmv\") AS \"MTD GMV\", avg(MTD_gmv)/avg(LMTD_gmv) -1 AS \"MTD Gmv Growth\", sum(\"7d_avg_nr\") AS \"7d avg NR\", sum(\"Yday_nr\") AS \"Yday NR\", avg(yday_nr)/avg(\"7d_avg_nr\")- 1 AS \"Yday NR Growth\", sum(\"LMTD_nr\") AS \"LMTD NR\", sum(\"MTD_nr\") AS \"MTD NR\", avg(MTD_nr)/avg(LMTD_nr) - 1 AS \"MTD NR Grwoth\" \nFROM (with A as(\nSELECT * FROM (\nSELECT day_id AS day_id, online_merchant_name AS online_merchant_name, dau AS dau, mau AS mau, \"NR\" AS \"NR\", new AS new, \"React\" AS \"React\", n_txns AS n_txns, gmv AS gmv \nFROM (with upi_flow_wise_base as (\nselect a.*, b.online_merchant_name, date_trunc('month',day_id) mnt,\ncase when day_id between date_trunc('month',current_date - interval '01' day) and current_date - interval '01' day then 'MTD'\nwhen day_id between date_trunc('month',current_date - interval '01' day - interval '01' month) and current_date - interval '01' day - interval '01' month then 'LMTD'\nend as periods,\n--row_number() over (partition by payer_cust_id,b.online_merchant_name, date_trunc('month', date(cast(txn_timestamp as timestamp ))) order by txn_timestamp) as rn_online_merchant_name\nrow_number() over (partition by customer_id, date_trunc('month', date(day_id)) order by created_on) as rn_ft\nfrom (\nselect\ntransaction_date_key day_id,\ncustomer_id_payer customer_id,\ntxn_timestamp created_on,\ntxn_id,\namount,\npayee_vpa,\nCASE                        \n        WHEN flow_category IN ('P2P') THEN 'P2P'\n        WHEN flow_category IN ('3P QR', 'Paytm QR') THEN 'SnP'\n        WHEN flow_category IN ('Intent', 'P2M Collect','Mandate_Online') THEN 'Online'\n        WHEN flow_category IN ('Onus_ExcMandates','Mandate_Onus') THEN 'Onus'\n        ELSE 'Others' \nEND AS final_category\n\nfrom  cdo.fact_upi_transactions_snapshot_v3\nwhere dl_last_updated >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)\nand transaction_type in('PAY','COLLECT')\nand category in ('VPA2ACCOUNT','VPA2VPA','VPA2MERCHANT')\nand status = 'SUCCESS'\nand lower(payer_handle) in ('paytm','ptyes','ptaxis','pthdfc','ptsbi')\n\n)a\nleft JOIN  user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on LOWER(a.payee_vpa) = LOWER(b.payee_vpa)\n),\n\npaytm_nrr AS (\n      SELECT customer_id customer_id, date_trunc('month',date(txn_date) ) mnt, txn_date day_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type\n      FROM  user_paytm_payments.rolling_nrr_v1 \n      WHERE txn_date >= date'2025-08-01'\n      and user_type not IN ('Repeat')\n       and\n        customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt >=  date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n        and channel in (\n        'fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ) \n        union all\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt >=  date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n        and channel in (\n        'fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong') \n        )\n      )\n\n-- select day_id,txn_id,customer_id,online_merchant_name,amount,rn_ft,mnt,\n-- row_number() over (partition by customer_id,online_merchant_name, date_trunc('month', day_id) order by day_id) as rn_mau\n-- from  upi_flow_wise_base \n--                 where \n--                 -- lower(online_merchant_name) in (select lower(online_merchant_name) from user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss)\n--                 -- and\n--                 final_category = 'Online'\n\n-- and day_id >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)      \n\nselect\na.day_id,\nonline_merchant_name,\n        count(distinct a.customer_id) as dau,\n        count(distinct case when a.rn_mau = 1 then a.customer_id end) as mau,\n        count(distinct case when a.rn_ft = 1 and b.customer_id is not null then a.customer_id  end) as NR, --- paytm new/react \n        count(distinct case when a.rn_ft = 1 and b.user_type = 'New' then a.customer_id  end) as new, --- paytm new/react \n        count(distinct case when a.rn_ft = 1 and  b.user_type = 'React_2M+' then a.customer_id  end) as React, --- paytm new/react \n        count(distinct a.txn_id) as n_txns,\n        sum(cast (amount as double)) as gmv\n\nfrom\n(  \nselect day_id,txn_id,customer_id,online_merchant_name,amount,rn_ft,mnt,\nrow_number() over (partition by customer_id,online_merchant_name, date_trunc('month', day_id) order by day_id) as rn_mau\nfrom  upi_flow_wise_base \n                where lower(online_merchant_name) in (select lower(online_merchant_name) from user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss)\n                and final_category = 'Online'\n\nand day_id >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n)a\nleft join paytm_nrr b on a.customer_id = b.customer_id  and a.mnt = b.mnt\ngroup by 1,2\n\nUNION ALL\n\nselect \n        a.day_id,\n        'overall' as online_merchant_name,\n        count(distinct a.customer_id) as dau,\n        count(distinct case when rn_mau = 1 then a.customer_id end) as mau,\n        count(distinct case when rn_ft = 1 and b.customer_id is not null then a.customer_id  end) as NR, --- paytm new/react\n        count(distinct case when a.rn_ft = 1 and b.user_type = 'New' then a.customer_id  end) as new, --- paytm new/react \n        count(distinct case when a.rn_ft = 1 and  b.user_type = 'React_2M+' then a.customer_id  end) as React, --- paytm new/react \n \n        count(distinct txn_id) as n_txns,\n        sum(cast (amount as double)) as gmv\nfrom\n      (  \nselect day_id,txn_id,customer_id,online_merchant_name,amount,rn_ft,mnt,\nrow_number() over (partition by customer_id, date_trunc('month', day_id) order by day_id) as rn_mau\nfrom  upi_flow_wise_base \n                where final_category = 'Online'\nand day_id >= date_trunc('month',current_Date - interval  '01' day - interval '01' month)\n)a\nleft join paytm_nrr b on a.customer_id = b.customer_id and a.day_id = b.day_id\ngroup by 1,2\n) AS virtual_table\n) AS dataset_970\n)\n\n,Date_ as(\nSELECT date_column\nFROM UNNEST(\n    SEQUENCE(\n        date_trunc('month', current_date - interval '1' month),\n        current_date - interval '1' day,\n        interval '1' day\n    )\n) AS t(date_column)\n)\n\n\n\n,date_a as (\nselect \ndate_column,\ncase \nwhen date_column between date_trunc('month',current_date  - interval '01' day) and (current_date  - interval '01' day) then 'MTD'\nwhen date_column between date_trunc('month',current_date  - interval '01' day - interval '01' month ) and (current_date  - interval '01' day - interval '01' month ) then 'LMTD'\nend as MTD_Flag,\ncase when date_column = (current_date  - interval '01' day) then 'Yesterday'\nwhen date_column between (current_date  - interval '08' day) and (current_date  - interval '02' day) then 'last_7_day'\nend as yday_flag from date_\n)\n\nselect\nonline_merchant_name,\nsum(dau) filter(where yday_flag = 'Yesterday') Yday_DAU,\nsum(nr) filter(where yday_flag = 'Yesterday') Yday_nr,\nsum(new) filter(where yday_flag = 'Yesterday') Yday_new,\nsum(react) filter(where yday_flag = 'Yesterday') Yday_react,\nsum(n_txns) filter(where yday_flag = 'Yesterday') Yday_txns,\nsum(gmv) filter(where yday_flag = 'Yesterday') Yday_gmv,\n\navg(dau) filter(where yday_flag = 'last_7_day') \"7d_avg_DAU\",\navg(nr) filter(where yday_flag = 'last_7_day') \"7d_avg_nr\",\navg(new) filter(where yday_flag = 'last_7_day') \"7d_avg_new\",\navg(react) filter(where yday_flag = 'last_7_day') \"7d_avg_react\",\navg(n_txns) filter(where yday_flag = 'last_7_day') \"7d_avg_txns\",\navg(gmv) filter(where yday_flag = 'last_7_day') \"7d_avg_gmv\",\n\nsum(mau) filter(where MTD_Flag = 'LMTD') LMTD_mau,\nsum(nr) filter(where MTD_Flag = 'LMTD') LMTD_nr,\nsum(new) filter(where MTD_Flag = 'LMTD') LMTD_new,\nsum(react) filter(where MTD_Flag = 'LMTD') LMTD_react,\nsum(n_txns) filter(where MTD_Flag = 'LMTD') LMTD_txns,\nsum(gmv) filter(where MTD_Flag = 'LMTD') LMTD_gmv,\n----\nsum(mau) filter(where MTD_Flag = 'MTD') MTD_mau,\nsum(nr) filter(where MTD_Flag = 'MTD') MTD_nr,\nsum(new) filter(where MTD_Flag = 'MTD') MTD_new,\nsum(react) filter(where MTD_Flag = 'MTD') MTD_react,\nsum(n_txns) filter(where MTD_Flag = 'MTD') MTD_txns,\nsum(gmv) filter(where MTD_Flag = 'MTD') MTD_gmv\n--max(day_id) data_as_of\n\nfrom A a join date_a b on a.day_id in(b.date_column)\nwhere MTD_Flag is not null or yday_flag is not null\nGROUP by 1\norder by MTD_txns desc\n) AS virtual_table GROUP BY online_merchant_name ORDER BY \"7d avg DAU\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_DAU",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29039,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg DAU",
          "optionName": "metric_mmc77phdm9_w0v2ur3iw0f",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_DAU",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29033,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Yday DAU",
          "optionName": "metric_vg7su0hv4sj_555h5vqdhp3",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday DAU Growth",
          "optionName": "metric_3nd22o7mz1b_qa34ht686oh",
          "sqlExpression": "AVG(Yday_DAU)/AVG(\"7d_avg_DAU\") - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_mau",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29045,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD MAU",
          "optionName": "metric_3zudxo2gn9b_nmcy2aiosr",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_mau",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29051,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD MAU",
          "optionName": "metric_yi2d82qy8cq_98xmoa3x9v6",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD MAU Growth",
          "optionName": "metric_1yyono6nr6a_f77kutc46q",
          "sqlExpression": "AVG(MTD_mau)/AVG(LMTD_mau) - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29037,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "yday txns",
          "optionName": "metric_lijmt5b5a1p_qpr5i2vfxx",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29043,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg Txns",
          "optionName": "metric_iq0fci6k1ts_1pz0mmnty23",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday Txn Growth",
          "optionName": "metric_s7clrjizfj_969vjbggsqa",
          "sqlExpression": "avg(Yday_txns)/avg(\"7d_avg_txns\") - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29049,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Txns",
          "optionName": "metric_s6xbe9surf_rxoh8e8gxwi",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29055,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Txns",
          "optionName": "metric_0ds85p3f4nqr_ih9dvwnked",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Txn _Growth",
          "optionName": "metric_99o6jna8ptl_8w0v044oqt",
          "sqlExpression": "avg(MTD_txns)/avg(LMTD_txns)-1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29044,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg Gmv",
          "optionName": "metric_hmwxe4ss019_qhdui9hukv",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29038,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "yday Gmv",
          "optionName": "metric_paowi30he5f_ccnwof5iqci",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday Gmv Growth",
          "optionName": "metric_vdeqm6mc1kj_tvonee5792",
          "sqlExpression": "avg(Yday_gmv)/avg(\"7d_avg_gmv\") - 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29050,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Gmv",
          "optionName": "metric_5bm1v45odp_3h5x99qkpmf",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_gmv",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29056,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD GMV",
          "optionName": "metric_ehwmyfgqsdo_8h41fzrhpbv",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Gmv Growth",
          "optionName": "metric_6pg55sfa739_oprs9qf0v7",
          "sqlExpression": "avg(MTD_gmv)/avg(LMTD_gmv) -1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "7d_avg_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29040,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "7d avg NR",
          "optionName": "metric_5nflc5zxj5v_ww19yw93c3",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "Yday_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29034,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Yday NR",
          "optionName": "metric_2buommkriop_wcoo7mx1n4q",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Yday NR Growth",
          "optionName": "metric_83imv4uahbj_l6xjsssfdph",
          "sqlExpression": "avg(yday_nr)/avg(\"7d_avg_nr\")- 1"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29046,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD NR",
          "optionName": "metric_sq4kmfxsblf_y484p865nwf",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_nr",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 29052,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD NR",
          "optionName": "metric_6h5tmrh9iq8_hr02kogp8q8",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD NR Grwoth",
          "optionName": "metric_1ei0jqk5enm_0w3d14qovji",
          "sqlExpression": "avg(MTD_nr)/avg(LMTD_nr) - 1"
        }
      ],
      "columns": [
        "online_merchant_name",
        "Yday_DAU",
        "Yday_nr",
        "Yday_new",
        "Yday_react",
        "Yday_txns",
        "Yday_gmv",
        "7d_avg_DAU",
        "7d_avg_nr",
        "7d_avg_new",
        "7d_avg_react",
        "7d_avg_txns",
        "7d_avg_gmv",
        "LMTD_mau",
        "LMTD_nr",
        "LMTD_new",
        "LMTD_react",
        "LMTD_txns",
        "LMTD_gmv",
        "MTD_mau",
        "MTD_nr",
        "MTD_new",
        "MTD_react",
        "MTD_txns",
        "MTD_gmv"
      ],
      "groupby_columns": [
        "online_merchant_name"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 3462,
      "chart_name": "3P Online - Overall MTD LMTD FT RT Summary",
      "chart_type": "table",
      "dataset_id": 1477,
      "dataset_name": "3P online ft rt overall MTD",
      "database_name": "Trino",
      "sql_query": "SELECT paytm_user_type AS paytm_user_type, sum(users_mtd) AS \"MTD Users\", sum(txns_mtd) AS \"MTD Txns\", sum(gmv_mtd) AS \"MTD Gmv\", sum(txns_mtd*1.00)/sum(users_mtd*1.00) AS \"TPU\", sum(users_lmtd) AS \"LMTD Users\", sum(txns_lmtd) AS \"LMTD Txns\", sum(gmv_lmtd) AS \"LMTD Gmv\", sum(txns_lmtd*1.00)/sum(users_lmtd*1.00) AS \"LMTD TPU\", (SUM(users_mtd)*1.0000)\n/\n(SUM(users_lmtd)*1.0000) -1 AS \"MTD User Growth\", (SUM(txns_mtd)*1.0000)\n/\n(SUM(txns_lmtd)*1.0000) -1 AS \"MTD Txn Growth\", (SUM(gmv_mtd)*1.0000)\n/\n(SUM(gmv_lmtd)*1.0000) -1 AS \"MTD Gmv Growth\" \nFROM (WITH date_ranges AS (\n          SELECT\n              DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE)) AS mtd_start,\n              DATE_ADD('day', -1, CURRENT_DATE) AS mtd_end,\n              DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))) AS lmtd_start,\n              DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)) AS lmtd_end\n      ),\n\n      paytm_nrr_mtd AS (\n      WITH paytm_nrr AS (\n      SELECT txn_date day_id,payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date,customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type\n      FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n            Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt between (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n        and lower(channel) in (\n        'fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ) )\n\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      )\n      SELECT day_id,payer_cust_id, paytm_user_type, 'MTD' AS period FROM paytm_nrr\n      ),\n\n      paytm_nrr_lmtd AS (\n      WITH paytm_nrr AS (\n      SELECT txn_date day_id,payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date,customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type\n      FROM hive.user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n\n      and customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt between (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      )\n      SELECT day_id, payer_cust_id, paytm_user_type, 'LMTD' AS period FROM paytm_nrr\n      ),\n\n      upi_online_ft AS (\n      SELECT day_id,payer_cust_id, 'MTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category,day_id,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay\n      WHERE day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges) -- MTD Source\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n\n      UNION ALL\n\n      SELECT day_id,payer_cust_id, 'LMTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category,day_id,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay\n      where day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n      ),\n\n      upi_online_txns AS (\n      SELECT payer_cust_id,day_id, COUNT(txn_id) AS n_txns, SUM(amount) AS gmv, 'MTD' AS period\n      FROM user_paytm_payments.upi_abhay  -- MTD Source\n      WHERE payer_cust_id IN (SELECT payer_cust_id FROM upi_online_ft WHERE period = 'MTD')\n      AND day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n      GROUP BY 1,2\n\n      UNION ALL\n\n      SELECT payer_cust_id,day_id, COUNT(txn_id) AS n_txns, SUM(amount) AS gmv, 'LMTD' AS period\n      FROM user_paytm_payments.upi_abhay  -- LMTD Source\n      WHERE payer_cust_id IN (SELECT payer_cust_id FROM upi_online_ft WHERE period = 'LMTD')\n      AND day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      GROUP BY 1,2\n      ),\n\n      final_base as (\n      SELECT\n      a.paytm_user_type,\n      a.period,\n      COUNT(DISTINCT a.payer_cust_id) AS users,\n      COALESCE(SUM(n_txns), 0) AS n_txns,\n      COALESCE(SUM(gmv), 0) AS gmv\n      FROM (\n      SELECT * FROM paytm_nrr_mtd\n      UNION ALL\n      SELECT * FROM paytm_nrr_lmtd\n      ) AS a\n      INNER JOIN upi_online_ft AS b\n      ON a.payer_cust_id = b.payer_cust_id\n      -- AND a.period = b.period\n      and a.day_id = b.day_id\n      LEFT JOIN upi_online_txns AS c\n      ON b.payer_cust_id = c.payer_cust_id\n      -- AND b.period = c.period\n      and b.day_id = c.day_id\n      GROUP BY 1, 2\n      ORDER BY 3, 1\n      )\n\n      select\n      paytm_user_type,\n      sum(case when period = 'MTD' then users end) as users_mtd,\n      sum(case when period = 'MTD' then n_txns end) as txns_mtd,\n      sum(case when period = 'MTD' then gmv end) as gmv_mtd,\n\n      sum(case when period = 'LMTD' then users end) as users_lmtd,\n      sum(case when period = 'LMTD' then n_txns end) as txns_lmtd,\n      sum(case when period = 'LMTD' then gmv end) as gmv_lmtd\n      from final_base\n      group by 1\n) AS virtual_table GROUP BY paytm_user_type ORDER BY \"MTD Users\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "users_mtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31784,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Users",
          "optionName": "metric_vab7qxq0z2e_gwlx6g78r9g",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "txns_mtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31785,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Txns",
          "optionName": "metric_zxbcy1pprc_r45xjklyh9p",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "gmv_mtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31786,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Gmv",
          "optionName": "metric_idgd7q8t2d_kvesixkreh",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "TPU",
          "optionName": "metric_92snydeddva_59wgdfg2uiw",
          "sqlExpression": "sum(txns_mtd*1.00)/sum(users_mtd*1.00)"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "users_lmtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31787,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Users",
          "optionName": "metric_z3ryf4y59n_c5ph48n46bv",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "txns_lmtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31788,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Txns",
          "optionName": "metric_w6gq7w85mal_wlzkx2p3q9n",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "gmv_lmtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31789,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Gmv",
          "optionName": "metric_uw9a6rq7t7m_pju5ns55ju",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "LMTD TPU",
          "optionName": "metric_4hgcw3b37dp_fhqr0t0v23",
          "sqlExpression": "sum(txns_lmtd*1.00)/sum(users_lmtd*1.00)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD User Growth",
          "optionName": "metric_2mcgdw36ete_7u5phxbv45c",
          "sqlExpression": "(SUM(users_mtd)*1.0000)\n/\n(SUM(users_lmtd)*1.0000) -1"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Txn Growth",
          "optionName": "metric_s4doegp3fp_uthk04l7n7d",
          "sqlExpression": "(SUM(txns_mtd)*1.0000)\n/\n(SUM(txns_lmtd)*1.0000) -1"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Gmv Growth",
          "optionName": "metric_8m7uoierwlh_v2u9vyw72vq",
          "sqlExpression": "(SUM(gmv_mtd)*1.0000)\n/\n(SUM(gmv_lmtd)*1.0000) -1"
        }
      ],
      "columns": [
        "paytm_user_type",
        "gmv_mtd",
        "users_lmtd",
        "txns_lmtd",
        "gmv_lmtd",
        "users_mtd",
        "txns_mtd"
      ],
      "groupby_columns": [
        "paytm_user_type"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 3462,
      "chart_name": "3P Online - Overall MTD LMTD FT RT Summary",
      "chart_type": "table",
      "dataset_id": 1477,
      "dataset_name": "3P online ft rt overall MTD",
      "database_name": "Trino",
      "sql_query": "SELECT paytm_user_type AS paytm_user_type, sum(users_mtd) AS \"MTD Users\", sum(txns_mtd) AS \"MTD Txns\", sum(gmv_mtd) AS \"MTD Gmv\", sum(txns_mtd*1.00)/sum(users_mtd*1.00) AS \"TPU\", sum(users_lmtd) AS \"LMTD Users\", sum(txns_lmtd) AS \"LMTD Txns\", sum(gmv_lmtd) AS \"LMTD Gmv\", sum(txns_lmtd*1.00)/sum(users_lmtd*1.00) AS \"LMTD TPU\", (SUM(users_mtd)*1.0000)\n/\n(SUM(users_lmtd)*1.0000) -1 AS \"MTD User Growth\", (SUM(txns_mtd)*1.0000)\n/\n(SUM(txns_lmtd)*1.0000) -1 AS \"MTD Txn Growth\", (SUM(gmv_mtd)*1.0000)\n/\n(SUM(gmv_lmtd)*1.0000) -1 AS \"MTD Gmv Growth\" \nFROM (WITH date_ranges AS (\n          SELECT\n              DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE)) AS mtd_start,\n              DATE_ADD('day', -1, CURRENT_DATE) AS mtd_end,\n              DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))) AS lmtd_start,\n              DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)) AS lmtd_end\n      ),\n\n      paytm_nrr_mtd AS (\n      WITH paytm_nrr AS (\n      SELECT txn_date day_id,payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date,customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type\n      FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n            Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt between (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n        and lower(channel) in (\n        'fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ) )\n\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      )\n      SELECT day_id,payer_cust_id, paytm_user_type, 'MTD' AS period FROM paytm_nrr\n      ),\n\n      paytm_nrr_lmtd AS (\n      WITH paytm_nrr AS (\n      SELECT txn_date day_id,payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date,customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type\n      FROM hive.user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n\n      and customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt between (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      )\n      SELECT day_id, payer_cust_id, paytm_user_type, 'LMTD' AS period FROM paytm_nrr\n      ),\n\n      upi_online_ft AS (\n      SELECT day_id,payer_cust_id, 'MTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category,day_id,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay\n      WHERE day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges) -- MTD Source\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n\n      UNION ALL\n\n      SELECT day_id,payer_cust_id, 'LMTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category,day_id,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay\n      where day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n      ),\n\n      upi_online_txns AS (\n      SELECT payer_cust_id,day_id, COUNT(txn_id) AS n_txns, SUM(amount) AS gmv, 'MTD' AS period\n      FROM user_paytm_payments.upi_abhay  -- MTD Source\n      WHERE payer_cust_id IN (SELECT payer_cust_id FROM upi_online_ft WHERE period = 'MTD')\n      AND day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n      GROUP BY 1,2\n\n      UNION ALL\n\n      SELECT payer_cust_id,day_id, COUNT(txn_id) AS n_txns, SUM(amount) AS gmv, 'LMTD' AS period\n      FROM user_paytm_payments.upi_abhay  -- LMTD Source\n      WHERE payer_cust_id IN (SELECT payer_cust_id FROM upi_online_ft WHERE period = 'LMTD')\n      AND day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      GROUP BY 1,2\n      ),\n\n      final_base as (\n      SELECT\n      a.paytm_user_type,\n      a.period,\n      COUNT(DISTINCT a.payer_cust_id) AS users,\n      COALESCE(SUM(n_txns), 0) AS n_txns,\n      COALESCE(SUM(gmv), 0) AS gmv\n      FROM (\n      SELECT * FROM paytm_nrr_mtd\n      UNION ALL\n      SELECT * FROM paytm_nrr_lmtd\n      ) AS a\n      INNER JOIN upi_online_ft AS b\n      ON a.payer_cust_id = b.payer_cust_id\n      -- AND a.period = b.period\n      and a.day_id = b.day_id\n      LEFT JOIN upi_online_txns AS c\n      ON b.payer_cust_id = c.payer_cust_id\n      -- AND b.period = c.period\n      and b.day_id = c.day_id\n      GROUP BY 1, 2\n      ORDER BY 3, 1\n      )\n\n      select\n      paytm_user_type,\n      sum(case when period = 'MTD' then users end) as users_mtd,\n      sum(case when period = 'MTD' then n_txns end) as txns_mtd,\n      sum(case when period = 'MTD' then gmv end) as gmv_mtd,\n\n      sum(case when period = 'LMTD' then users end) as users_lmtd,\n      sum(case when period = 'LMTD' then n_txns end) as txns_lmtd,\n      sum(case when period = 'LMTD' then gmv end) as gmv_lmtd\n      from final_base\n      group by 1\n) AS virtual_table GROUP BY paytm_user_type ORDER BY \"MTD Users\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "users_mtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31784,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Users",
          "optionName": "metric_vab7qxq0z2e_gwlx6g78r9g",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "txns_mtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31785,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Txns",
          "optionName": "metric_zxbcy1pprc_r45xjklyh9p",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "gmv_mtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31786,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD Gmv",
          "optionName": "metric_idgd7q8t2d_kvesixkreh",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "TPU",
          "optionName": "metric_92snydeddva_59wgdfg2uiw",
          "sqlExpression": "sum(txns_mtd*1.00)/sum(users_mtd*1.00)"
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "users_lmtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31787,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Users",
          "optionName": "metric_z3ryf4y59n_c5ph48n46bv",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "txns_lmtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31788,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Txns",
          "optionName": "metric_w6gq7w85mal_wlzkx2p3q9n",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "gmv_lmtd",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31789,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "DOUBLE",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD Gmv",
          "optionName": "metric_uw9a6rq7t7m_pju5ns55ju",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "LMTD TPU",
          "optionName": "metric_4hgcw3b37dp_fhqr0t0v23",
          "sqlExpression": "sum(txns_lmtd*1.00)/sum(users_lmtd*1.00)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD User Growth",
          "optionName": "metric_2mcgdw36ete_7u5phxbv45c",
          "sqlExpression": "(SUM(users_mtd)*1.0000)\n/\n(SUM(users_lmtd)*1.0000) -1"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Txn Growth",
          "optionName": "metric_s4doegp3fp_uthk04l7n7d",
          "sqlExpression": "(SUM(txns_mtd)*1.0000)\n/\n(SUM(txns_lmtd)*1.0000) -1"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD Gmv Growth",
          "optionName": "metric_8m7uoierwlh_v2u9vyw72vq",
          "sqlExpression": "(SUM(gmv_mtd)*1.0000)\n/\n(SUM(gmv_lmtd)*1.0000) -1"
        }
      ],
      "columns": [
        "paytm_user_type",
        "gmv_mtd",
        "users_lmtd",
        "txns_lmtd",
        "gmv_lmtd",
        "users_mtd",
        "txns_mtd"
      ],
      "groupby_columns": [
        "paytm_user_type"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 3463,
      "chart_name": "FT/RT DoD Merchant Level (Apply Merchant filter on top for any specific merchant)",
      "chart_type": "table",
      "dataset_id": 1478,
      "dataset_name": "3P online FT RT Merchant Level",
      "database_name": "Trino",
      "sql_query": "SELECT day_id AS day_id__, sum(\"MTD_New_Users\") AS \"MTD New users\", sum(\"MTD_React2Mplus_Users\") AS \"MTD React Users\", sum(\"LMTD_New_Users\") AS \"LMTD New Users\", sum(\"LMTD_React2Mplus_Users\") AS \"LMTD React Users\", SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users) AS \"MTD New + React Users\", SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users) AS \"LMTD New + React Users\", (SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1 AS \"New user Growth\", (SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1 AS \"React User Growth\", ((SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n((SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1 AS \"New+React User Growth\" \nFROM (WITH date_ranges AS (\n          SELECT\n              DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE)) AS mtd_start,\n              DATE_ADD('day', -1, CURRENT_DATE) AS mtd_end,\n              DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))) AS lmtd_start,\n              DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)) AS lmtd_end\n      ),\n\n      paytm_nrr_mtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n         FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt between (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'MTD' AS period FROM paytm_nrr\n      ),\n\n      paytm_nrr_lmtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n     FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n            Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt between (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'LMTD' AS period FROM paytm_nrr\n      ),\n\n      upi_online_ft AS (\n      SELECT payer_cust_id, day_id,online_merchant_name, 'MTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      WHERE day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges) -- MTD Source\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n\n      UNION ALL\n\n      SELECT payer_cust_id, day_id,online_merchant_name, 'LMTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      where day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n      )\n\n      SELECT\n      day(b.day_id) as day_id,\n      b.online_merchant_name,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_Repeat_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_Repeat_Users\n\n      FROM (\n      SELECT * FROM paytm_nrr_mtd\n      UNION ALL\n      SELECT * FROM paytm_nrr_lmtd\n      ) AS a\n      INNER JOIN upi_online_ft AS b\n      ON a.payer_cust_id = b.payer_cust_id\n      -- AND a.period = b.period\n      and a.dt = b.day_id\n      GROUP BY 1, 2\n      ORDER BY 3, 1\n) AS virtual_table GROUP BY day_id ORDER BY max(day_id) ASC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31792,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD New users",
          "optionName": "metric_qrr50h4q558_4wl8cs1c06c",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31793,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD React Users",
          "optionName": "metric_tr7vw5ip92q_nylohy0tuj",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31794,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD New Users",
          "optionName": "metric_qu55duk27m_wg8bmjgtdc8",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31795,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD React Users",
          "optionName": "metric_lboxpxpolum_xy5i5lpnmb",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD New + React Users",
          "optionName": "metric_1anp37k9b7a_nunyssrd7lr",
          "sqlExpression": "SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "LMTD New + React Users",
          "optionName": "metric_6xpnixqn7vp_8st60qhdc",
          "sqlExpression": "SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New user Growth",
          "optionName": "metric_pfo2ekokwk_k5fmlame9h",
          "sqlExpression": "(SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1\n"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "React User Growth",
          "optionName": "metric_ryy6hg1xqnn_2bbint3fbwr",
          "sqlExpression": "(SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New+React User Growth",
          "optionName": "metric_7kxi4m5qpm5_h7c2rwig2ro",
          "sqlExpression": "((SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n((SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1"
        }
      ],
      "columns": [
        "day_id",
        "online_merchant_name",
        "MTD_React2Mplus_Users",
        "LMTD_New_Users",
        "LMTD_React2Mplus_Users",
        "MTD_Repeat_Users",
        "LMTD_Repeat_Users",
        "MTD_New_Users"
      ],
      "groupby_columns": [
        "day_id"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 3463,
      "chart_name": "FT/RT DoD Merchant Level (Apply Merchant filter on top for any specific merchant)",
      "chart_type": "table",
      "dataset_id": 1478,
      "dataset_name": "3P online FT RT Merchant Level",
      "database_name": "Trino",
      "sql_query": "SELECT day_id AS day_id__, sum(\"MTD_New_Users\") AS \"MTD New users\", sum(\"MTD_React2Mplus_Users\") AS \"MTD React Users\", sum(\"LMTD_New_Users\") AS \"LMTD New Users\", sum(\"LMTD_React2Mplus_Users\") AS \"LMTD React Users\", SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users) AS \"MTD New + React Users\", SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users) AS \"LMTD New + React Users\", (SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1 AS \"New user Growth\", (SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1 AS \"React User Growth\", ((SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n((SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1 AS \"New+React User Growth\" \nFROM (WITH date_ranges AS (\n          SELECT\n              DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE)) AS mtd_start,\n              DATE_ADD('day', -1, CURRENT_DATE) AS mtd_end,\n              DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))) AS lmtd_start,\n              DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)) AS lmtd_end\n      ),\n\n      paytm_nrr_mtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n         FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt between (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'MTD' AS period FROM paytm_nrr\n      ),\n\n      paytm_nrr_lmtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n     FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n            Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt between (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'LMTD' AS period FROM paytm_nrr\n      ),\n\n      upi_online_ft AS (\n      SELECT payer_cust_id, day_id,online_merchant_name, 'MTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      WHERE day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges) -- MTD Source\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n\n      UNION ALL\n\n      SELECT payer_cust_id, day_id,online_merchant_name, 'LMTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      where day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n      )\n\n      SELECT\n      day(b.day_id) as day_id,\n      b.online_merchant_name,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_Repeat_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_Repeat_Users\n\n      FROM (\n      SELECT * FROM paytm_nrr_mtd\n      UNION ALL\n      SELECT * FROM paytm_nrr_lmtd\n      ) AS a\n      INNER JOIN upi_online_ft AS b\n      ON a.payer_cust_id = b.payer_cust_id\n      -- AND a.period = b.period\n      and a.dt = b.day_id\n      GROUP BY 1, 2\n      ORDER BY 3, 1\n) AS virtual_table GROUP BY day_id ORDER BY max(day_id) ASC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31792,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD New users",
          "optionName": "metric_qrr50h4q558_4wl8cs1c06c",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31793,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD React Users",
          "optionName": "metric_tr7vw5ip92q_nylohy0tuj",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31794,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD New Users",
          "optionName": "metric_qu55duk27m_wg8bmjgtdc8",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31795,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD React Users",
          "optionName": "metric_lboxpxpolum_xy5i5lpnmb",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD New + React Users",
          "optionName": "metric_1anp37k9b7a_nunyssrd7lr",
          "sqlExpression": "SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "LMTD New + React Users",
          "optionName": "metric_6xpnixqn7vp_8st60qhdc",
          "sqlExpression": "SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New user Growth",
          "optionName": "metric_pfo2ekokwk_k5fmlame9h",
          "sqlExpression": "(SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1\n"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "React User Growth",
          "optionName": "metric_ryy6hg1xqnn_2bbint3fbwr",
          "sqlExpression": "(SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New+React User Growth",
          "optionName": "metric_7kxi4m5qpm5_h7c2rwig2ro",
          "sqlExpression": "((SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n((SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1"
        }
      ],
      "columns": [
        "day_id",
        "online_merchant_name",
        "MTD_React2Mplus_Users",
        "LMTD_New_Users",
        "LMTD_React2Mplus_Users",
        "MTD_Repeat_Users",
        "LMTD_Repeat_Users",
        "MTD_New_Users"
      ],
      "groupby_columns": [
        "day_id"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 3562,
      "chart_name": "online_category_missingvpa_mapping",
      "chart_type": "table",
      "dataset_id": 1505,
      "dataset_name": "online_category_missingvpa_mapping",
      "database_name": "Trino",
      "sql_query": "SELECT payee_vpa AS payee_vpa, online_merchant_name AS online_merchant_name, sum(n_txns) AS \"Txns(>100)\" \nFROM (select lower(a.payee_vpa) as payee_vpa, a.online_merchant_name,\ncount(txn_id) as n_txns\nfrom\n user_paytm_payments.upi_flow_wise_base_cm a\nleft JOIN user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on LOWER(a.payee_vpa) = LOWER(b.payee_vpa)\nwhere dl_last_updated >= date_trunc('month',current_Date - interval '01' day)\nand final_category = 'Online'\nand b.online_merchant_name is null\ngroup by 1,2\nhaving count(*) > 100\norder by 3 desc\n) AS virtual_table GROUP BY payee_vpa, online_merchant_name ORDER BY \"Txns(>100)\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "n_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 32246,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Txns(>100)",
          "optionName": "metric_0c9i9ppdrgas_ct7o31bauhp",
          "sqlExpression": null
        }
      ],
      "columns": [
        "n_txns",
        "payee_vpa",
        "online_merchant_name"
      ],
      "groupby_columns": [
        "payee_vpa",
        "online_merchant_name"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 3562,
      "chart_name": "online_category_missingvpa_mapping",
      "chart_type": "table",
      "dataset_id": 1505,
      "dataset_name": "online_category_missingvpa_mapping",
      "database_name": "Trino",
      "sql_query": "SELECT payee_vpa AS payee_vpa, online_merchant_name AS online_merchant_name, sum(n_txns) AS \"Txns(>100)\" \nFROM (select lower(a.payee_vpa) as payee_vpa, a.online_merchant_name,\ncount(txn_id) as n_txns\nfrom\n user_paytm_payments.upi_flow_wise_base_cm a\nleft JOIN user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on LOWER(a.payee_vpa) = LOWER(b.payee_vpa)\nwhere dl_last_updated >= date_trunc('month',current_Date - interval '01' day)\nand final_category = 'Online'\nand b.online_merchant_name is null\ngroup by 1,2\nhaving count(*) > 100\norder by 3 desc\n) AS virtual_table GROUP BY payee_vpa, online_merchant_name ORDER BY \"Txns(>100)\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "n_txns",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 32246,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Txns(>100)",
          "optionName": "metric_0c9i9ppdrgas_ct7o31bauhp",
          "sqlExpression": null
        }
      ],
      "columns": [
        "n_txns",
        "payee_vpa",
        "online_merchant_name"
      ],
      "groupby_columns": [
        "payee_vpa",
        "online_merchant_name"
      ],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 6505,
      "chart_name": "MTU_Live_Non_Live_Top_15_",
      "chart_type": "table",
      "dataset_id": 2872,
      "dataset_name": "Live_NonLive_MTU_3P_Online",
      "database_name": "Trino",
      "sql_query": "SELECT date_trunc('day', CAST(mnt AS TIMESTAMP)) AS mnt, sum(overall_mtu) AS \"Overall_MTU__\", sum(live_merchants) AS \"Live_Merch_MTU\", sum(non_live_exc_live) AS \"Non_Live_MTU(excld_Live)\", sum(\"Top_15_merc\") AS \"Top_15_Merch_MTU\", sum(\"Top_1K_MTU\") AS \"Top_1K_MTU\" \nFROM (with base_ as (\nselect\nmnt,\npayer_cust_id,\nSUM(1)\nfilter (where \n      lower(online_merchant_name) IN ('flipkart','Reliance','blinkit','zomato','swiggy','meesho','bharti','zepto','rapido','myntra','vodafone',\n        'mpokket','bookmyshow','gokwik','jar','district','kreditbee','bigbasket','jiomart','cashfree','urban company','fancode','Paytm PG',\n        'tataplay','hungerbox','nykaa','ola cabs','burger king','stage','magicpin','zee5','DMRC Momentum',\n        '1mg','apollo','ajio','firstcry','chartr','eatclub','kfc','pharmeasy','zivame','pvr','snapdeal','gaana com','bbdaily','ketto online ventures pvt',\n        'ferns n petal','gullak','rentomojo','dish tv','chaupal tv','healthians','tata play binge','rail yatri','igp','aha media','bakingo','nearbuy','netmeds'\n        ,'Intrcity','d2h','freeup','floweraura','bix42','walmart')\n)Live_MTU,\nSUM(1) filter (where \n       lower(online_merchant_name) IN ('meesho','flipkart','zomato','Reliance','Myntra','bharti','gokwik','swiggy','rapido',\n'blinkit','zepto','bookmyshow','mpokket','jar','vodafone') \n)Top_15_MTU, \nSUM(1)\nfilter (where \n        lower(online_merchant_name) Not IN ('flipkart','Reliance','blinkit','zomato','swiggy','meesho','bharti','zepto','rapido','myntra','vodafone',\n        'mpokket','bookmyshow','gokwik','jar','district','kreditbee','bigbasket','jiomart','cashfree','urban company','fancode','Paytm PG',\n        'tataplay','hungerbox','nykaa','ola cabs','burger king','stage','magicpin','zee5','DMRC Momentum',\n        '1mg','apollo','ajio','firstcry','chartr','eatclub','kfc','pharmeasy','zivame','pvr','snapdeal','gaana com','bbdaily','ketto online ventures pvt',\n        'ferns n petal','gullak','rentomojo','dish tv','chaupal tv','healthians','tata play binge','rail yatri','igp','aha media','bakingo','nearbuy','netmeds'\n        ,'Intrcity','d2h','freeup','floweraura','bix42','walmart')\n        )\nNon_Live_MTU,\nSUM(1) filter (where  top_1k = 1) top_1K_MTU\nfrom \n(\nselect mnt,\npayer_cust_id,\ncoalesce(b.online_merchant_name,'aaaaaaaaaa')online_merchant_name,\ncase when TP.online_merchant_name is not null then 1 else 0 end as top_1k\nfrom\n        (\n           select distinct  date_Trunc('month',day_id)mnt, payer_cust_id,payee_vpa\n        FROM user_paytm_payments.upi_abhay --user_paytm_payments.upi_flow_wise_base_partitioned\n        WHERE\n            day_id >= date_trunc('month',(current_Date - interval '01' day - interval '01' month))\n            AND day(day_id) <= day(current_Date - interval '01' day)\n            AND final_category = 'Online'\n        ) a\n        left join (SELECT payee_vpa,lower(online_merchant_name) online_merchant_name\n        FROM (\n        select *, row_number() over(partition by payee_vpa order by updated_on DESC) as rn from user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1\n        )\n        WHERE RN=1\n        ) b\n        ON LOWER(a.payee_vpa) = lower(b.payee_vpa)   \n        \n        LEFT JOIN (SELECT DISTINCT online_merchant_name from  user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss) TP\n          ON lower(b.online_merchant_name) = lower(tp.online_merchant_name)\n)\ngroup by 1,2\n) \n\nselect \nmnt,\ncount(distinct payer_cust_id) overall_mtu\n,count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0)>=1) live_merchants\n,count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0)>=1 and coalesce(Non_Live_MTU,0)>=1) live_n_non_live\n,count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0) =0 and coalesce(Non_Live_MTU,0)>=1) non_live_exc_live\n,count(distinct payer_cust_id) filter(where coalesce(Top_15_MTU,0)>=1) Top_15_merc\n,count(distinct payer_cust_id) filter(where coalesce(top_1K_MTU,0)>=1) Top_1K_MTU\nfrom base_\ngroup by 1\n) AS virtual_table GROUP BY date_trunc('day', CAST(mnt AS TIMESTAMP)) ORDER BY sum(overall_mtu) DESC\nLIMIT 5000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963547",
            "column_name": "overall_mtu",
            "created_on": "2025-11-24T07:28:02.963543",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76496,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "dfd679c4-848b-4a1a-8c4a-a9222a339882",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Overall_MTU",
          "optionName": "metric_fktkcm877t5_8im7cltxb8o",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963588",
            "column_name": "live_merchants",
            "created_on": "2025-11-24T07:28:02.963586",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76497,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "146f3b02-6b26-49f0-b3ee-dd5bad125d52",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Live_Merch_MTU",
          "optionName": "metric_q8t4vhz78a_afdihmnyscm",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963638",
            "column_name": "non_live_exc_live",
            "created_on": "2025-11-24T07:28:02.963636",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76499,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "ffaefffc-2cda-4681-aea4-a2b4ec3b56a3",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Non_Live_MTU(excld_Live)",
          "optionName": "metric_k3rw3lr5hkb_7lrpntigch",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963662",
            "column_name": "Top_15_merc",
            "created_on": "2025-11-24T07:28:02.963660",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76500,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "c25e26bf-9ded-4080-99d5-5d448319fd69",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Top_15_Merch_MTU",
          "optionName": "metric_pob22cvqnj_6zt5ga630ow",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963686",
            "column_name": "Top_1K_MTU",
            "created_on": "2025-11-24T07:28:02.963684",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76501,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "2591e3ca-e6e4-450f-a26a-f90131eb2ebd",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Top_1K_MTU",
          "optionName": "metric_ib172vfck0e_t1ri6r72asc",
          "sqlExpression": null
        }
      ],
      "columns": [
        "mnt",
        "overall_mtu",
        "live_merchants",
        "live_n_non_live",
        "non_live_exc_live",
        "Top_15_merc",
        "Top_1K_MTU"
      ],
      "groupby_columns": [
        "mnt"
      ],
      "filters": [
        {
          "clause": "WHERE",
          "comparator": "No filter",
          "expressionType": "SIMPLE",
          "operator": "TEMPORAL_RANGE",
          "subject": "mnt"
        }
      ],
      "time_range": null
    },
    {
      "chart_id": 6505,
      "chart_name": "MTU_Live_Non_Live_Top_15_",
      "chart_type": "table",
      "dataset_id": 2872,
      "dataset_name": "Live_NonLive_MTU_3P_Online",
      "database_name": "Trino",
      "sql_query": "SELECT date_trunc('day', CAST(mnt AS TIMESTAMP)) AS mnt, sum(overall_mtu) AS \"Overall_MTU__\", sum(live_merchants) AS \"Live_Merch_MTU\", sum(non_live_exc_live) AS \"Non_Live_MTU(excld_Live)\", sum(\"Top_15_merc\") AS \"Top_15_Merch_MTU\", sum(\"Top_1K_MTU\") AS \"Top_1K_MTU\" \nFROM (with base_ as (\nselect\nmnt,\npayer_cust_id,\nSUM(1)\nfilter (where \n      lower(online_merchant_name) IN ('flipkart','Reliance','blinkit','zomato','swiggy','meesho','bharti','zepto','rapido','myntra','vodafone',\n        'mpokket','bookmyshow','gokwik','jar','district','kreditbee','bigbasket','jiomart','cashfree','urban company','fancode','Paytm PG',\n        'tataplay','hungerbox','nykaa','ola cabs','burger king','stage','magicpin','zee5','DMRC Momentum',\n        '1mg','apollo','ajio','firstcry','chartr','eatclub','kfc','pharmeasy','zivame','pvr','snapdeal','gaana com','bbdaily','ketto online ventures pvt',\n        'ferns n petal','gullak','rentomojo','dish tv','chaupal tv','healthians','tata play binge','rail yatri','igp','aha media','bakingo','nearbuy','netmeds'\n        ,'Intrcity','d2h','freeup','floweraura','bix42','walmart')\n)Live_MTU,\nSUM(1) filter (where \n       lower(online_merchant_name) IN ('meesho','flipkart','zomato','Reliance','Myntra','bharti','gokwik','swiggy','rapido',\n'blinkit','zepto','bookmyshow','mpokket','jar','vodafone') \n)Top_15_MTU, \nSUM(1)\nfilter (where \n        lower(online_merchant_name) Not IN ('flipkart','Reliance','blinkit','zomato','swiggy','meesho','bharti','zepto','rapido','myntra','vodafone',\n        'mpokket','bookmyshow','gokwik','jar','district','kreditbee','bigbasket','jiomart','cashfree','urban company','fancode','Paytm PG',\n        'tataplay','hungerbox','nykaa','ola cabs','burger king','stage','magicpin','zee5','DMRC Momentum',\n        '1mg','apollo','ajio','firstcry','chartr','eatclub','kfc','pharmeasy','zivame','pvr','snapdeal','gaana com','bbdaily','ketto online ventures pvt',\n        'ferns n petal','gullak','rentomojo','dish tv','chaupal tv','healthians','tata play binge','rail yatri','igp','aha media','bakingo','nearbuy','netmeds'\n        ,'Intrcity','d2h','freeup','floweraura','bix42','walmart')\n        )\nNon_Live_MTU,\nSUM(1) filter (where  top_1k = 1) top_1K_MTU\nfrom \n(\nselect mnt,\npayer_cust_id,\ncoalesce(b.online_merchant_name,'aaaaaaaaaa')online_merchant_name,\ncase when TP.online_merchant_name is not null then 1 else 0 end as top_1k\nfrom\n        (\n           select distinct  date_Trunc('month',day_id)mnt, payer_cust_id,payee_vpa\n        FROM user_paytm_payments.upi_abhay --user_paytm_payments.upi_flow_wise_base_partitioned\n        WHERE\n            day_id >= date_trunc('month',(current_Date - interval '01' day - interval '01' month))\n            AND day(day_id) <= day(current_Date - interval '01' day)\n            AND final_category = 'Online'\n        ) a\n        left join (SELECT payee_vpa,lower(online_merchant_name) online_merchant_name\n        FROM (\n        select *, row_number() over(partition by payee_vpa order by updated_on DESC) as rn from user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1\n        )\n        WHERE RN=1\n        ) b\n        ON LOWER(a.payee_vpa) = lower(b.payee_vpa)   \n        \n        LEFT JOIN (SELECT DISTINCT online_merchant_name from  user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss) TP\n          ON lower(b.online_merchant_name) = lower(tp.online_merchant_name)\n)\ngroup by 1,2\n) \n\nselect \nmnt,\ncount(distinct payer_cust_id) overall_mtu\n,count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0)>=1) live_merchants\n,count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0)>=1 and coalesce(Non_Live_MTU,0)>=1) live_n_non_live\n,count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0) =0 and coalesce(Non_Live_MTU,0)>=1) non_live_exc_live\n,count(distinct payer_cust_id) filter(where coalesce(Top_15_MTU,0)>=1) Top_15_merc\n,count(distinct payer_cust_id) filter(where coalesce(top_1K_MTU,0)>=1) Top_1K_MTU\nfrom base_\ngroup by 1\n) AS virtual_table GROUP BY date_trunc('day', CAST(mnt AS TIMESTAMP)) ORDER BY sum(overall_mtu) DESC\nLIMIT 5000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963547",
            "column_name": "overall_mtu",
            "created_on": "2025-11-24T07:28:02.963543",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76496,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "dfd679c4-848b-4a1a-8c4a-a9222a339882",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Overall_MTU",
          "optionName": "metric_fktkcm877t5_8im7cltxb8o",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963588",
            "column_name": "live_merchants",
            "created_on": "2025-11-24T07:28:02.963586",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76497,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "146f3b02-6b26-49f0-b3ee-dd5bad125d52",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Live_Merch_MTU",
          "optionName": "metric_q8t4vhz78a_afdihmnyscm",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963638",
            "column_name": "non_live_exc_live",
            "created_on": "2025-11-24T07:28:02.963636",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76499,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "ffaefffc-2cda-4681-aea4-a2b4ec3b56a3",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Non_Live_MTU(excld_Live)",
          "optionName": "metric_k3rw3lr5hkb_7lrpntigch",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963662",
            "column_name": "Top_15_merc",
            "created_on": "2025-11-24T07:28:02.963660",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76500,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "c25e26bf-9ded-4080-99d5-5d448319fd69",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Top_15_Merch_MTU",
          "optionName": "metric_pob22cvqnj_6zt5ga630ow",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "changed_on": "2025-11-24T07:28:02.963686",
            "column_name": "Top_1K_MTU",
            "created_on": "2025-11-24T07:28:02.963684",
            "description": null,
            "expression": null,
            "extra": "{}",
            "filterable": true,
            "groupby": true,
            "id": 76501,
            "is_active": true,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "uuid": "2591e3ca-e6e4-450f-a26a-f90131eb2ebd",
            "verbose_name": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "Top_1K_MTU",
          "optionName": "metric_ib172vfck0e_t1ri6r72asc",
          "sqlExpression": null
        }
      ],
      "columns": [
        "mnt",
        "overall_mtu",
        "live_merchants",
        "live_n_non_live",
        "non_live_exc_live",
        "Top_15_merc",
        "Top_1K_MTU"
      ],
      "groupby_columns": [
        "mnt"
      ],
      "filters": [
        {
          "clause": "WHERE",
          "comparator": "No filter",
          "expressionType": "SIMPLE",
          "operator": "TEMPORAL_RANGE",
          "subject": "mnt"
        }
      ],
      "time_range": null
    },
    {
      "chart_id": 6680,
      "chart_name": "FT/RT DoD Merchant Level (Top 15)",
      "chart_type": "table",
      "dataset_id": 1478,
      "dataset_name": "3P online FT RT Merchant Level",
      "database_name": "Trino",
      "sql_query": "SELECT online_merchant_name AS online_merchant_name, day_id AS day_id__, sum(\"MTD_New_Users\") AS \"MTD New users\", sum(\"MTD_React2Mplus_Users\") AS \"MTD React Users\", sum(\"LMTD_New_Users\") AS \"LMTD New Users\", sum(\"LMTD_React2Mplus_Users\") AS \"LMTD React Users\", SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users) AS \"MTD New + React Users\", SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users) AS \"LMTD New + React Users\", case when SUM(LMTD_New_Users) = 0 then 0 else\n\n(SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1\n\nend AS \"New user Growth\", case when SUM(LMTD_React2Mplus_Users) = 0 then 0 else\n(SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1\nend AS \"React User Growth\", case when \nSUM(LMTD_New_Users) + sum(LMTD_React2Mplus_Users) = 0 then 0 else\n\n(\n(SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n(\n(\nSUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1\nend AS \"New+React User Growth\" \nFROM (WITH date_ranges AS (\n          SELECT\n              DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE)) AS mtd_start,\n              DATE_ADD('day', -1, CURRENT_DATE) AS mtd_end,\n              DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))) AS lmtd_start,\n              DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)) AS lmtd_end\n      ),\n\n      paytm_nrr_mtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n         FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt between (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'MTD' AS period FROM paytm_nrr\n      ),\n\n      paytm_nrr_lmtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n     FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n            Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt between (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'LMTD' AS period FROM paytm_nrr\n      ),\n\n      upi_online_ft AS (\n      SELECT payer_cust_id, day_id,online_merchant_name, 'MTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      WHERE day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges) -- MTD Source\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n\n      UNION ALL\n\n      SELECT payer_cust_id, day_id,online_merchant_name, 'LMTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      where day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n      )\n\n      SELECT\n      day(b.day_id) as day_id,\n      b.online_merchant_name,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_Repeat_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_Repeat_Users\n\n      FROM (\n      SELECT * FROM paytm_nrr_mtd\n      UNION ALL\n      SELECT * FROM paytm_nrr_lmtd\n      ) AS a\n      INNER JOIN upi_online_ft AS b\n      ON a.payer_cust_id = b.payer_cust_id\n      -- AND a.period = b.period\n      and a.dt = b.day_id\n      GROUP BY 1, 2\n      ORDER BY 3, 1\n) AS virtual_table \nWHERE ((online_merchant_name IN ('meesho', 'flipkart', 'zomato', 'reliance', 'myntra', 'bharti', 'gokwik', 'swiggy', 'rapido', 'blinkit', 'zepto', 'bookmyshow', 'mpokket', 'jar', 'vodafone'))) GROUP BY online_merchant_name, day_id ORDER BY max(day_id) ASC\nLIMIT 10000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31792,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD New users",
          "optionName": "metric_qrr50h4q558_4wl8cs1c06c",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31793,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD React Users",
          "optionName": "metric_tr7vw5ip92q_nylohy0tuj",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31794,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD New Users",
          "optionName": "metric_qu55duk27m_wg8bmjgtdc8",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31795,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD React Users",
          "optionName": "metric_lboxpxpolum_xy5i5lpnmb",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD New + React Users",
          "optionName": "metric_1anp37k9b7a_nunyssrd7lr",
          "sqlExpression": "SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "LMTD New + React Users",
          "optionName": "metric_6xpnixqn7vp_8st60qhdc",
          "sqlExpression": "SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New user Growth",
          "optionName": "metric_pfo2ekokwk_k5fmlame9h",
          "sqlExpression": "case when SUM(LMTD_New_Users) = 0 then 0 else\n\n(SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1\n\nend"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "React User Growth",
          "optionName": "metric_ryy6hg1xqnn_2bbint3fbwr",
          "sqlExpression": "case when SUM(LMTD_React2Mplus_Users) = 0 then 0 else\n(SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1\nend"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New+React User Growth",
          "optionName": "metric_7kxi4m5qpm5_h7c2rwig2ro",
          "sqlExpression": "case when \nSUM(LMTD_New_Users) + sum(LMTD_React2Mplus_Users) = 0 then 0 else\n\n(\n(SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n(\n(\nSUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1\nend"
        }
      ],
      "columns": [
        "day_id",
        "online_merchant_name",
        "MTD_React2Mplus_Users",
        "LMTD_New_Users",
        "LMTD_React2Mplus_Users",
        "MTD_Repeat_Users",
        "LMTD_Repeat_Users",
        "MTD_New_Users"
      ],
      "groupby_columns": [
        "online_merchant_name",
        "day_id"
      ],
      "filters": [
        {
          "expressionType": "SQL",
          "sqlExpression": "online_merchant_name IN ('meesho', 'flipkart', 'zomato', 'reliance', 'myntra', 'bharti', 'gokwik', 'swiggy', 'rapido', 'blinkit', 'zepto', 'bookmyshow', 'mpokket', 'jar', 'vodafone')",
          "clause": "WHERE",
          "subject": null,
          "operator": null,
          "comparator": null,
          "isExtra": false,
          "isNew": false,
          "datasourceWarning": false,
          "filterOptionName": "filter_r53t199lfc_hjs0g073szh"
        }
      ],
      "time_range": null
    },
    {
      "chart_id": 6680,
      "chart_name": "FT/RT DoD Merchant Level (Top 15)",
      "chart_type": "table",
      "dataset_id": 1478,
      "dataset_name": "3P online FT RT Merchant Level",
      "database_name": "Trino",
      "sql_query": "SELECT online_merchant_name AS online_merchant_name, day_id AS day_id__, sum(\"MTD_New_Users\") AS \"MTD New users\", sum(\"MTD_React2Mplus_Users\") AS \"MTD React Users\", sum(\"LMTD_New_Users\") AS \"LMTD New Users\", sum(\"LMTD_React2Mplus_Users\") AS \"LMTD React Users\", SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users) AS \"MTD New + React Users\", SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users) AS \"LMTD New + React Users\", case when SUM(LMTD_New_Users) = 0 then 0 else\n\n(SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1\n\nend AS \"New user Growth\", case when SUM(LMTD_React2Mplus_Users) = 0 then 0 else\n(SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1\nend AS \"React User Growth\", case when \nSUM(LMTD_New_Users) + sum(LMTD_React2Mplus_Users) = 0 then 0 else\n\n(\n(SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n(\n(\nSUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1\nend AS \"New+React User Growth\" \nFROM (WITH date_ranges AS (\n          SELECT\n              DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE)) AS mtd_start,\n              DATE_ADD('day', -1, CURRENT_DATE) AS mtd_end,\n              DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))) AS lmtd_start,\n              DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)) AS lmtd_end\n      ),\n\n      paytm_nrr_mtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n         FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n        Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic\n        where dt between (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n           ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'MTD' AS period FROM paytm_nrr\n      ),\n\n      paytm_nrr_lmtd AS (\n      WITH paytm_nrr AS (\n      SELECT dt, payer_cust_id, user_type AS paytm_user_type\n      FROM (\n      SELECT txn_date dt, customer_id AS payer_cust_id,\n      CASE\n      WHEN user_type = 'New' THEN 'New'\n      WHEN user_type = 'Repeat' THEN 'Repeat'\n      ELSE 'React_2M+'\n      END AS user_type,\n      row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date) krn\n     FROM user_paytm_payments.rolling_nrr_v1 --hive.user_paytm_payments.paytm_mau_final_nrr_exc\n      WHERE txn_date BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n       and\n\n        customer_Id not in (\n            Select cust_id from user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic\n        where dt between (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n        and lower(channel) in ('fmcg','masu online','masu offline','1. masu offline via fse','2. masu via p4b app','3. masu via paytm app','4. merchant gets user offline via qr code','5. merchant gets user via soundbox','6. merchant gets user via referral (p4b app)','7. fse as payer'\n        ,'1.a. fse gets merchants as user'\n        ,'1.b. fse gets merchants as other'\n        ,'1.c.ong'\n        ))\n      )\n      WHERE user_type IN ('New', 'React_2M+')\n      --where krn = 1\n      )\n      SELECT dt, payer_cust_id, paytm_user_type, 'LMTD' AS period FROM paytm_nrr\n      ),\n\n      upi_online_ft AS (\n      SELECT payer_cust_id, day_id,online_merchant_name, 'MTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      WHERE day_id BETWEEN (SELECT mtd_start FROM date_ranges) AND (SELECT mtd_end FROM date_ranges) -- MTD Source\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n\n      UNION ALL\n\n      SELECT payer_cust_id, day_id,online_merchant_name, 'LMTD' AS period\n      FROM (\n      SELECT payer_cust_id, final_category, day_id,b.online_merchant_name,\n      ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC) AS rnk\n      FROM user_paytm_payments.upi_abhay a\n      left join user_paytm_payments.upi_3p_online_merchant_vpa_mapping b on lower(a.payee_vpa) = lower(b.payee_vpa)\n      where day_id BETWEEN (SELECT lmtd_start FROM date_ranges) AND (SELECT lmtd_end FROM date_ranges)\n      )\n      WHERE final_category = 'Online'\n      AND rnk = 1\n\n      )\n\n      SELECT\n      day(b.day_id) as day_id,\n      b.online_merchant_name,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'New' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_New_Users,\n      count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_React2Mplus_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'MTD' then  a.payer_cust_id end) as MTD_Repeat_Users,\n      count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'LMTD' then  a.payer_cust_id end) as LMTD_Repeat_Users\n\n      FROM (\n      SELECT * FROM paytm_nrr_mtd\n      UNION ALL\n      SELECT * FROM paytm_nrr_lmtd\n      ) AS a\n      INNER JOIN upi_online_ft AS b\n      ON a.payer_cust_id = b.payer_cust_id\n      -- AND a.period = b.period\n      and a.dt = b.day_id\n      GROUP BY 1, 2\n      ORDER BY 3, 1\n) AS virtual_table \nWHERE ((online_merchant_name IN ('meesho', 'flipkart', 'zomato', 'reliance', 'myntra', 'bharti', 'gokwik', 'swiggy', 'rapido', 'blinkit', 'zepto', 'bookmyshow', 'mpokket', 'jar', 'vodafone'))) GROUP BY online_merchant_name, day_id ORDER BY max(day_id) ASC\nLIMIT 10000;\n\n",
      "metrics": [
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31792,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD New users",
          "optionName": "metric_qrr50h4q558_4wl8cs1c06c",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "MTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31793,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "MTD React Users",
          "optionName": "metric_tr7vw5ip92q_nylohy0tuj",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_New_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31794,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD New Users",
          "optionName": "metric_qu55duk27m_wg8bmjgtdc8",
          "sqlExpression": null
        },
        {
          "aggregate": "SUM",
          "column": {
            "advanced_data_type": null,
            "certification_details": null,
            "certified_by": null,
            "column_name": "LMTD_React2Mplus_Users",
            "description": null,
            "expression": null,
            "filterable": true,
            "groupby": true,
            "id": 31795,
            "is_certified": false,
            "is_dttm": false,
            "python_date_format": null,
            "type": "BIGINT",
            "type_generic": 0,
            "verbose_name": null,
            "warning_markdown": null
          },
          "datasourceWarning": false,
          "expressionType": "SIMPLE",
          "hasCustomLabel": true,
          "label": "LMTD React Users",
          "optionName": "metric_lboxpxpolum_xy5i5lpnmb",
          "sqlExpression": null
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "MTD New + React Users",
          "optionName": "metric_1anp37k9b7a_nunyssrd7lr",
          "sqlExpression": "SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "LMTD New + React Users",
          "optionName": "metric_6xpnixqn7vp_8st60qhdc",
          "sqlExpression": "SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New user Growth",
          "optionName": "metric_pfo2ekokwk_k5fmlame9h",
          "sqlExpression": "case when SUM(LMTD_New_Users) = 0 then 0 else\n\n(SUM(MTD_New_Users)*1.0000)/\n(SUM(LMTD_New_Users)*1.0000)-1\n\nend"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "React User Growth",
          "optionName": "metric_ryy6hg1xqnn_2bbint3fbwr",
          "sqlExpression": "case when SUM(LMTD_React2Mplus_Users) = 0 then 0 else\n(SUM(MTD_React2Mplus_Users)*1.0000)/\n(SUM(LMTD_React2Mplus_Users)*1.0000)-1\nend"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "New+React User Growth",
          "optionName": "metric_7kxi4m5qpm5_h7c2rwig2ro",
          "sqlExpression": "case when \nSUM(LMTD_New_Users) + sum(LMTD_React2Mplus_Users) = 0 then 0 else\n\n(\n(SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users)\n)*1.0000)\n/\n(\n(\nSUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users)\n)*1.0000) - 1\nend"
        }
      ],
      "columns": [
        "day_id",
        "online_merchant_name",
        "MTD_React2Mplus_Users",
        "LMTD_New_Users",
        "LMTD_React2Mplus_Users",
        "MTD_Repeat_Users",
        "LMTD_Repeat_Users",
        "MTD_New_Users"
      ],
      "groupby_columns": [
        "online_merchant_name",
        "day_id"
      ],
      "filters": [
        {
          "expressionType": "SQL",
          "sqlExpression": "online_merchant_name IN ('meesho', 'flipkart', 'zomato', 'reliance', 'myntra', 'bharti', 'gokwik', 'swiggy', 'rapido', 'blinkit', 'zepto', 'bookmyshow', 'mpokket', 'jar', 'vodafone')",
          "clause": "WHERE",
          "subject": null,
          "operator": null,
          "comparator": null,
          "isExtra": false,
          "isNew": false,
          "datasourceWarning": false,
          "filterOptionName": "filter_r53t199lfc_hjs0g073szh"
        }
      ],
      "time_range": null
    }
  ]
}