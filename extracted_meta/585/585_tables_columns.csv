tables_involved,column_names,alias_column_name,source_or_derived,derived_column_logic,column_datatype,extra,comment
hive.cdo.fact_upi_transactions_snapshot_v3,7d_avg_DAU,7d avg DAU,derived,"sum(""7d_avg_DAU"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,7d_avg_gmv,7d avg Gmv,derived,"sum(""7d_avg_gmv"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,7d_avg_nr,7d avg NR,derived,"sum(""7d_avg_nr"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,7d_avg_txns,7d avg Txns,derived,"sum(""7d_avg_txns"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,LMTD_gmv,LMTD Gmv,derived,"sum(""LMTD_gmv"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,LMTD_mau,LMTD MAU,derived,"sum(""LMTD_mau"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,LMTD_nr,LMTD NR,derived,"sum(""LMTD_nr"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,LMTD_txns,LMTD Txns,derived,"sum(""LMTD_txns"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_gmv,MTD GMV,derived,"sum(""MTD_gmv"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_gmv,MTD Gmv Growth,derived,avg(MTD_gmv)/avg(LMTD_gmv) -1,,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_mau,MTD MAU,derived,"sum(""MTD_mau"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_mau,MTD MAU Growth,derived,AVG(MTD_mau)/AVG(LMTD_mau) - 1,,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_nr,MTD NR,derived,"sum(""MTD_nr"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_nr,MTD NR Grwoth,derived,avg(MTD_nr)/avg(LMTD_nr) - 1,,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_txns,MTD Txn _Growth,derived,avg(MTD_txns)/avg(LMTD_txns)-1,,,
hive.cdo.fact_upi_transactions_snapshot_v3,MTD_txns,MTD Txns,derived,"sum(""MTD_txns"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_DAU,Yday DAU,derived,"sum(""Yday_DAU"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_DAU,Yday DAU Growth,derived,"AVG(Yday_DAU)/AVG(""7d_avg_DAU"") - 1",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_gmv,Yday Gmv Growth,derived,"avg(Yday_gmv)/avg(""7d_avg_gmv"") - 1",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_gmv,yday Gmv,derived,"sum(""Yday_gmv"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_nr,Yday NR,derived,"sum(""Yday_nr"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_nr,Yday NR Growth,derived,"avg(yday_nr)/avg(""7d_avg_nr"")- 1",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_txns,Yday Txn Growth,derived,"avg(Yday_txns)/avg(""7d_avg_txns"") - 1",,,
hive.cdo.fact_upi_transactions_snapshot_v3,Yday_txns,yday txns,derived,"sum(""Yday_txns"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,amount,amount,source,,double,,
hive.cdo.fact_upi_transactions_snapshot_v3,amount,gmv,derived,sum(cast (amount as double)),double,,
hive.cdo.fact_upi_transactions_snapshot_v3,category,category,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,channel,channel,source,,,,
hive.cdo.fact_upi_transactions_snapshot_v3,cust_id,cust_id,source,,,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,NR,derived,count(distinct case when a.rn_ft = 1 and b.customer_id is not null then a.customer_id end),,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,React,derived,count(distinct case when a.rn_ft = 1 and b.user_type = 'React_2M+' then a.customer_id end),,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,customer_id,source,,,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,dau,derived,count(distinct a.customer_id),,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,mau,derived,count(distinct case when a.rn_mau = 1 then a.customer_id end),,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,new,derived,count(distinct case when a.rn_ft = 1 and b.user_type = 'New' then a.customer_id end),,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,rn_ft,derived,"row_number() over (partition by customer_id, date_trunc('month', date(day_id)) order by created_on)",,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id,rn_mau,derived,"row_number() over (partition by customer_id,online_merchant_name, date_trunc('month', day_id) order by day_id)",,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id_payer,customer_id,derived,customer_id_payer customer_id,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id_payer,customer_id_payer,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,day_id,mnt,derived,"date_trunc('month',day_id) mnt",,,
hive.cdo.fact_upi_transactions_snapshot_v3,day_id,periods,derived,"case when day_id between date_trunc('month',current_date - interval '01' day) and current_date - interval '01' day then 'MTD' when day_id between date_trunc('month',current_date - interval '01' day - interval '01' month) and current_date - interval '01' day - interval '01' month then 'LMTD' end",,,
hive.cdo.fact_upi_transactions_snapshot_v3,dt,dt,source,,,,
hive.cdo.fact_upi_transactions_snapshot_v3,flow_category,final_category,derived,"CASE WHEN flow_category IN ('P2P') THEN 'P2P' WHEN flow_category IN ('3P QR', 'Paytm QR') THEN 'SnP' WHEN flow_category IN ('Intent', 'P2M Collect','Mandate_Online') THEN 'Online' WHEN flow_category IN ('Onus_ExcMandates','Mandate_Onus') THEN 'Onus' ELSE 'Others' END",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,flow_category,flow_category,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,online_merchant_name,online_merchant_name,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payee_vpa,payee_vpa,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payer_handle,payer_handle,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,status,status,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_date_key,day_id,derived,transaction_date_key day_id,date,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_date_key,transaction_date_key,source,,date,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_type,transaction_type,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_date,txn_date,source,,,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,n_txns,derived,count(distinct a.txn_id),varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,txn_id,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,created_on,derived,txn_timestamp created_on,timestamp(3),,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,txn_timestamp,source,,timestamp(3),,
hive.cdo.fact_upi_transactions_snapshot_v3,user_type,user_type,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,amount,amount,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,category,category,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,channel,channel,source,,varchar(44),,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,cust_id,cust_id,source,,varchar,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,customer_id,customer_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,customer_id_payer,customer_id_payer,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,day_id,day_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,dt,dt,source,,date,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,final_category,final_category,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,flow_category,flow_category,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,online_merchant_name,online_merchant_name,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,payee_vpa,payee_vpa,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,payer_cust_id,payer_cust_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,payer_handle,payer_handle,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,status,status,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,transaction_date_key,transaction_date_key,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,transaction_type,transaction_type,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,txn_date,txn_date,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,txn_id,txn_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,txn_timestamp,txn_timestamp,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_10_logic,user_type,user_type,source,,varchar(11),,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,amount,amount,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,category,category,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,channel,channel,source,,varchar(44),,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,cust_id,cust_id,source,,varchar,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,customer_id,customer_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,customer_id_payer,customer_id_payer,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,day_id,day_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,dt,dt,source,,date,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,final_category,final_category,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,flow_category,flow_category,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,online_merchant_name,online_merchant_name,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,payee_vpa,payee_vpa,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,payer_cust_id,payer_cust_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,payer_handle,payer_handle,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,status,status,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,transaction_date_key,transaction_date_key,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,transaction_type,transaction_type,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,txn_date,txn_date,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,txn_id,txn_id,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,txn_timestamp,txn_timestamp,source,,,,
hive.user_paytm_payments.ft_base_with_mapping_raw_rolling_nrr_with_online_cm_10_logic,user_type,user_type,source,,varchar(11),,
hive.user_paytm_payments.rolling_nrr_v1,LMTD_New_Users,LMTD New + React Users,derived,SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users),,,
hive.user_paytm_payments.rolling_nrr_v1,LMTD_New_Users,LMTD New Users,derived,"sum(""LMTD_New_Users"")",,,
hive.user_paytm_payments.rolling_nrr_v1,LMTD_React2Mplus_Users,LMTD React Users,derived,"sum(""LMTD_React2Mplus_Users"")",,,
hive.user_paytm_payments.rolling_nrr_v1,MTD_New_Users,MTD New + React Users,derived,SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users),,,
hive.user_paytm_payments.rolling_nrr_v1,MTD_New_Users,MTD New users,derived,"sum(""MTD_New_Users"")",,,
hive.user_paytm_payments.rolling_nrr_v1,MTD_New_Users,New user Growth,derived,(SUM(MTD_New_Users)*1.0000)/(SUM(LMTD_New_Users)*1.0000)-1,,,
hive.user_paytm_payments.rolling_nrr_v1,MTD_New_Users,New+React User Growth,derived,((SUM(MTD_New_Users) + SUM(MTD_React2Mplus_Users))*1.0000)/((SUM(LMTD_New_Users) + SUM(LMTD_React2Mplus_Users))*1.0000) - 1,,,
hive.user_paytm_payments.rolling_nrr_v1,MTD_React2Mplus_Users,MTD React Users,derived,"sum(""MTD_React2Mplus_Users"")",,,
hive.user_paytm_payments.rolling_nrr_v1,MTD_React2Mplus_Users,React User Growth,derived,(SUM(MTD_React2Mplus_Users)*1.0000)/(SUM(LMTD_React2Mplus_Users)*1.0000)-1,,,
hive.user_paytm_payments.rolling_nrr_v1,amount,amount,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,category,category,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,channel,channel,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,cust_id,cust_id,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,customer_id,customer_id,source,,varchar,,
hive.user_paytm_payments.rolling_nrr_v1,customer_id,krn,derived,"row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date)",varchar,,
hive.user_paytm_payments.rolling_nrr_v1,customer_id_payer,customer_id_payer,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,day_id,day_id,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,dt,dt,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,final_category,final_category,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,flow_category,flow_category,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,online_merchant_name,online_merchant_name,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,payee_vpa,payee_vpa,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,LMTD_New_Users,derived,count(distinct case when a.paytm_user_type = 'New' and a.period = 'LMTD' then  a.payer_cust_id end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,LMTD_React2Mplus_Users,derived,count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'LMTD' then  a.payer_cust_id end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,LMTD_Repeat_Users,derived,count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'LMTD' then  a.payer_cust_id end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,MTD_New_Users,derived,count(distinct case when a.paytm_user_type = 'New' and a.period = 'MTD' then  a.payer_cust_id end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,MTD_React2Mplus_Users,derived,count(distinct case when a.paytm_user_type = 'React_2M+' and a.period = 'MTD' then  a.payer_cust_id end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,MTD_Repeat_Users,derived,count(distinct case when a.paytm_user_type = 'Repeat' and a.period = 'MTD' then  a.payer_cust_id end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,payer_cust_id,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,users,derived,COUNT(DISTINCT a.payer_cust_id),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,users_lmtd,derived,sum(case when period = 'LMTD' then users end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_cust_id,users_mtd,derived,sum(case when period = 'MTD' then users end),,,
hive.user_paytm_payments.rolling_nrr_v1,payer_handle,payer_handle,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,status,status,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,transaction_date_key,transaction_date_key,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,transaction_type,transaction_type,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,txn_date,krn,derived,"row_number() over(partition by customer_id, date_Trunc('month',txn_date) order by txn_date)",date,,
hive.user_paytm_payments.rolling_nrr_v1,txn_date,lmtd_end,derived,"DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))",date,,
hive.user_paytm_payments.rolling_nrr_v1,txn_date,lmtd_start,derived,"DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)))",date,,
hive.user_paytm_payments.rolling_nrr_v1,txn_date,mtd_end,derived,"DATE_ADD('day', -1, CURRENT_DATE)",date,,
hive.user_paytm_payments.rolling_nrr_v1,txn_date,mtd_start,derived,"DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE))",date,,
hive.user_paytm_payments.rolling_nrr_v1,txn_date,txn_date,source,,date,,
hive.user_paytm_payments.rolling_nrr_v1,txn_id,txn_id,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,txn_timestamp,txn_timestamp,source,,,,
hive.user_paytm_payments.rolling_nrr_v1,user_type,paytm_user_type,derived,CASE WHEN user_type = 'New' THEN 'New' WHEN user_type = 'Repeat' THEN 'Repeat' ELSE 'React_2M+' END,varchar(9),,
hive.user_paytm_payments.rolling_nrr_v1,user_type,user_type,source,,varchar(9),,
hive.user_paytm_payments.rolling_nrr_v1,users_lmtd,LMTD Users,derived,sum(users_lmtd),,,
hive.user_paytm_payments.rolling_nrr_v1,users_mtd,MTD User Growth,derived,(SUM(users_mtd)*1.0000) / (SUM(users_lmtd)*1.0000) -1,,,
hive.user_paytm_payments.rolling_nrr_v1,users_mtd,MTD Users,derived,sum(users_mtd),,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,amount,amount,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,category,category,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,channel,channel,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,cust_id,cust_id,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,customer_id,customer_id,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,customer_id_payer,customer_id_payer,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,day_id,day_id,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,dt,dt,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,final_category,final_category,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,flow_category,flow_category,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,mnt,mnt,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,online_merchant_name,online_merchant_name,source,,varchar,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,online_merchant_name,top_1K_MTU,derived,SUM(1) filter (where  top_1k = 1),varchar,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,online_merchant_name,top_1k,derived,case when TP.online_merchant_name is not null then 1 else 0 end,varchar,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,payee_vpa,payee_vpa,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,payer_cust_id,payer_cust_id,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,payer_handle,payer_handle,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,status,status,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,transaction_date_key,transaction_date_key,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,transaction_type,transaction_type,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,txn_date,txn_date,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,txn_id,txn_id,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,txn_timestamp,txn_timestamp,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,updated_on,updated_on,source,,,,
hive.user_paytm_payments.top1000_merchnats_nov_dec_and_offeractive_ss,user_type,user_type,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,amount,amount,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,category,category,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,channel,channel,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,cust_id,cust_id,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,customer_id,customer_id,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,customer_id_payer,customer_id_payer,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,day_id,day_id,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,dl_last_updated,dl_last_updated,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,dt,dt,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,final_category,final_category,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,flow_category,flow_category,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,n_txns,n_txns,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,online_merchant_name,online_merchant_name,source,,varchar,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,payee_vpa,payee_vpa,source,,varchar,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,payer_cust_id,payer_cust_id,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,payer_handle,payer_handle,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,status,status,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,transaction_date_key,transaction_date_key,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,transaction_type,transaction_type,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,txn_date,txn_date,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,txn_id,txn_id,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,txn_timestamp,txn_timestamp,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping,user_type,user_type,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,day_id,day_id,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,final_category,final_category,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,mnt,mnt,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,online_merchant_name,Live_MTU,derived,"SUM(1) filter (where lower(online_merchant_name) IN ('flipkart','Reliance','blinkit','zomato','swiggy','meesho','bharti','zepto','rapido','myntra','vodafone','mpokket','bookmyshow','gokwik','jar','district','kreditbee','bigbasket','jiomart','cashfree','urban company','fancode','Paytm PG','tataplay','hungerbox','nykaa','ola cabs','burger king','stage','magicpin','zee5','DMRC Momentum','1mg','apollo','ajio','firstcry','chartr','eatclub','kfc','pharmeasy','zivame','pvr','snapdeal','gaana com','bbdaily','ketto online ventures pvt','ferns n petal','gullak','rentomojo','dish tv','chaupal tv','healthians','tata play binge','rail yatri','igp','aha media','bakingo','nearbuy','netmeds','Intrcity','d2h','freeup','floweraura','bix42','walmart'))",varchar,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,online_merchant_name,Non_Live_MTU,derived,"SUM(1) filter (where lower(online_merchant_name) Not IN ('flipkart','Reliance','blinkit','zomato','swiggy','meesho','bharti','zepto','rapido','myntra','vodafone','mpokket','bookmyshow','gokwik','jar','district','kreditbee','bigbasket','jiomart','cashfree','urban company','fancode','Paytm PG','tataplay','hungerbox','nykaa','ola cabs','burger king','stage','magicpin','zee5','DMRC Momentum','1mg','apollo','ajio','firstcry','chartr','eatclub','kfc','pharmeasy','zivame','pvr','snapdeal','gaana com','bbdaily','ketto online ventures pvt','ferns n petal','gullak','rentomojo','dish tv','chaupal tv','healthians','tata play binge','rail yatri','igp','aha media','bakingo','nearbuy','netmeds','Intrcity','d2h','freeup','floweraura','bix42','walmart'))",varchar,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,online_merchant_name,Top_15_MTU,derived,"SUM(1) filter (where lower(online_merchant_name) IN ('meesho','flipkart','zomato','Reliance','Myntra','bharti','gokwik','swiggy','rapido','blinkit','zepto','bookmyshow','mpokket','jar','vodafone'))",varchar,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,online_merchant_name,online_merchant_name,source,,varchar,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,payee_vpa,payee_vpa,source,,varchar,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,payer_cust_id,payer_cust_id,source,,,,
hive.user_paytm_payments.upi_3p_online_merchant_vpa_mapping_V1,updated_on,updated_on,source,,date,,
hive.user_paytm_payments.upi_abhay,amount,amount,source,,double,,
hive.user_paytm_payments.upi_abhay,amount,gmv,derived,SUM(amount),double,,
hive.user_paytm_payments.upi_abhay,amount,gmv_lmtd,derived,sum(case when period = 'LMTD' then gmv end),double,,
hive.user_paytm_payments.upi_abhay,amount,gmv_mtd,derived,sum(case when period = 'MTD' then gmv end),double,,
hive.user_paytm_payments.upi_abhay,channel,channel,source,,,,
hive.user_paytm_payments.upi_abhay,cust_id,cust_id,source,,,,
hive.user_paytm_payments.upi_abhay,customer_id,customer_id,source,,,,
hive.user_paytm_payments.upi_abhay,day_id,day_id,source,,date,,
hive.user_paytm_payments.upi_abhay,day_id,day_id__,derived,day_id AS day_id__,date,,
hive.user_paytm_payments.upi_abhay,day_id,lmtd_end,derived,"DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE))",date,,
hive.user_paytm_payments.upi_abhay,day_id,lmtd_start,derived,"DATE_TRUNC('MONTH', DATE_ADD('month', -1, DATE_ADD('day', -1, CURRENT_DATE)))",date,,
hive.user_paytm_payments.upi_abhay,day_id,mnt,derived,"date_trunc('day', CAST(mnt AS TIMESTAMP))",date,,
hive.user_paytm_payments.upi_abhay,day_id,mtd_end,derived,"DATE_ADD('day', -1, CURRENT_DATE)",date,,
hive.user_paytm_payments.upi_abhay,day_id,mtd_start,derived,"DATE_TRUNC('MONTH', DATE_ADD('day', -1, CURRENT_DATE))",date,,
hive.user_paytm_payments.upi_abhay,dt,dt,source,,,,
hive.user_paytm_payments.upi_abhay,final_category,final_category,source,,varchar(6),,
hive.user_paytm_payments.upi_abhay,gmv_lmtd,LMTD Gmv,derived,sum(gmv_lmtd),,,
hive.user_paytm_payments.upi_abhay,gmv_mtd,MTD Gmv,derived,sum(gmv_mtd),,,
hive.user_paytm_payments.upi_abhay,gmv_mtd,MTD Gmv Growth,derived,(SUM(gmv_mtd)*1.0000) / (SUM(gmv_lmtd)*1.0000) -1,,,
hive.user_paytm_payments.upi_abhay,mnt,mnt,source,,,,
hive.user_paytm_payments.upi_abhay,online_merchant_name,online_merchant_name,source,,varchar,,
hive.user_paytm_payments.upi_abhay,payee_vpa,payee_vpa,source,,varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,Live_Merch_MTU,derived,sum(live_merchants),varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,Non_Live_MTU(excld_Live),derived,sum(non_live_exc_live),varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,Overall_MTU__,derived,sum(overall_mtu),varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,Top_15_Merch_MTU,derived,"sum(""Top_15_merc"")",varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,Top_15_merc,derived,"count(distinct payer_cust_id) filter(where coalesce(Top_15_MTU,0)>=1)",varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,Top_1K_MTU,derived,"sum(""Top_1K_MTU"")",varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,live_merchants,derived,"count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0)>=1)",varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,non_live_exc_live,derived,"count(distinct payer_cust_id) filter(where coalesce(Live_MTU,0) =0 and coalesce(Non_Live_MTU,0)>=1)",varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,overall_mtu,derived,count(distinct payer_cust_id),varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,payer_cust_id,source,,varchar,,
hive.user_paytm_payments.upi_abhay,payer_cust_id,rnk,derived,ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC),varchar,,
hive.user_paytm_payments.upi_abhay,txn_date,txn_date,source,,,,
hive.user_paytm_payments.upi_abhay,txn_id,n_txns,derived,COUNT(txn_id),varchar,,
hive.user_paytm_payments.upi_abhay,txn_id,txn_id,source,,varchar,,
hive.user_paytm_payments.upi_abhay,txn_id,txns_lmtd,derived,sum(case when period = 'LMTD' then n_txns end),varchar,,
hive.user_paytm_payments.upi_abhay,txn_id,txns_mtd,derived,sum(case when period = 'MTD' then n_txns end),varchar,,
hive.user_paytm_payments.upi_abhay,txn_timestamp,rnk,derived,ROW_NUMBER() OVER (PARTITION BY payer_cust_id ORDER BY txn_timestamp ASC),timestamp(3),,
hive.user_paytm_payments.upi_abhay,txn_timestamp,txn_timestamp,source,,timestamp(3),,
hive.user_paytm_payments.upi_abhay,txns_lmtd,LMTD TPU,derived,sum(txns_lmtd*1.00)/sum(users_lmtd*1.00),,,
hive.user_paytm_payments.upi_abhay,txns_lmtd,LMTD Txns,derived,sum(txns_lmtd),,,
hive.user_paytm_payments.upi_abhay,txns_mtd,MTD Txn Growth,derived,(SUM(txns_mtd)*1.0000) / (SUM(txns_lmtd)*1.0000) -1,,,
hive.user_paytm_payments.upi_abhay,txns_mtd,MTD Txns,derived,sum(txns_mtd),,,
hive.user_paytm_payments.upi_abhay,txns_mtd,TPU,derived,sum(txns_mtd*1.00)/sum(users_mtd*1.00),,,
hive.user_paytm_payments.upi_abhay,updated_on,updated_on,source,,,,
hive.user_paytm_payments.upi_abhay,user_type,user_type,source,,,,
hive.user_paytm_payments.upi_flow_wise_base_cm,dl_last_updated,dl_last_updated,source,,date,,
hive.user_paytm_payments.upi_flow_wise_base_cm,final_category,final_category,source,,varchar(6),,
hive.user_paytm_payments.upi_flow_wise_base_cm,n_txns,Txns(>100),derived,sum(n_txns),,,
hive.user_paytm_payments.upi_flow_wise_base_cm,n_txns,n_txns,source,,,,
hive.user_paytm_payments.upi_flow_wise_base_cm,online_merchant_name,online_merchant_name,source,,varchar,,
hive.user_paytm_payments.upi_flow_wise_base_cm,payee_vpa,payee_vpa,source,,varchar,,
hive.user_paytm_payments.upi_flow_wise_base_cm,txn_id,n_txns,derived,count(txn_id),varchar,,
hive.user_paytm_payments.upi_flow_wise_base_cm,txn_id,txn_id,source,,varchar,,
