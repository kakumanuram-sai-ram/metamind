tables_involved,column_names,alias_column_name,source_or_derived,derived_column_logic,column_datatype,extra,comment
hive.cdo.fact_upi_transactions_snapshot_v3,amount,amount,source,,double,,
hive.cdo.fact_upi_transactions_snapshot_v3,app_resp_code,Error_code,derived,"coalesce(app_resp_code,npci_resp_code)",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,app_resp_code,app_resp_code,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,category,P2P_P2M,derived,"CASE WHEN category IN ('VPA2ACCOUNT','VPA2VPA') THEN 'P2P' WHEN category IN ('VPA2MERCHANT') THEN 'P2M' ELSE NULL END",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,category,category,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id_payer,customer_id,derived,customer_id_payer,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id_payer,customer_id_payer,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,dl_last_updated,dl_last_updated,source,,date,,
hive.cdo.fact_upi_transactions_snapshot_v3,flow_category,final_category,derived,"CASE WHEN flow_category IN ('P2P') THEN 'P2P' WHEN flow_category IN ('3P QR', 'Paytm QR') THEN 'SnP' WHEN flow_category IN ('Intent', 'P2M Collect','Mandate_Online') THEN 'Online' WHEN flow_category IN ('Onus_ExcMandates','Mandate_Onus') THEN 'Onus' ELSE 'Others' END",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,flow_category,flow_category,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,npci_resp_code,npci_resp_code,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payee_handle,payee_handle,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payee_handle,payee_psp,derived,"case when lower(payee_handle) in ('paytm','ptyes','ptaxis','pthdfc','ptsbi','ptybl','ptys','pty') then 'Payee as Paytm' else 'Payee as Others' end",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payer_bank_name,payer_bank_name,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payer_handle,payer_handle,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payer_handle,payer_psp,derived,"case when lower(payer_handle) in ('paytm','ptyes','ptaxis','pthdfc','ptsbi') then 'Payer as Paytm' else 'Payer as Others' end",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,purpose_code,purpose_code,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,status,status,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_date_key,Day,derived,Day(day_id),date,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_date_key,Month,derived,"date_trunc('month',day_id)",date,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_date_key,day_id,derived,transaction_date_key,date,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_date_key,transaction_date_key,source,,date,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_type,transaction_type,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,SR,derived,"(count(txn_id) filter(where status in('DEEMED','SUCCESS'))*1.0000)/(count(txn_id)*1.0000)",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,txn_id,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,created_on,derived,txn_timestamp,timestamp(3),,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,txn_timestamp,source,,timestamp(3),,
