[
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"amount",
    "alias_column_name":"amount",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"app_resp_code",
    "alias_column_name":"Error_code",
    "source_or_derived":"derived",
    "derived_column_logic":"coalesce(app_resp_code,npci_resp_code)"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"app_resp_code",
    "alias_column_name":"app_resp_code",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"category",
    "alias_column_name":"P2P_P2M",
    "source_or_derived":"derived",
    "derived_column_logic":"CASE WHEN category IN ('VPA2ACCOUNT','VPA2VPA') THEN 'P2P' WHEN category IN ('VPA2MERCHANT') THEN 'P2M' ELSE NULL END"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"category",
    "alias_column_name":"category",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"customer_id_payer",
    "alias_column_name":"customer_id",
    "source_or_derived":"derived",
    "derived_column_logic":"customer_id_payer"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"customer_id_payer",
    "alias_column_name":"customer_id_payer",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"dl_last_updated",
    "alias_column_name":"dl_last_updated",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"flow_category",
    "alias_column_name":"final_category",
    "source_or_derived":"derived",
    "derived_column_logic":"CASE WHEN flow_category IN ('P2P') THEN 'P2P' WHEN flow_category IN ('3P QR', 'Paytm QR') THEN 'SnP' WHEN flow_category IN ('Intent', 'P2M Collect','Mandate_Online') THEN 'Online' WHEN flow_category IN ('Onus_ExcMandates','Mandate_Onus') THEN 'Onus' ELSE 'Others' END"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"flow_category",
    "alias_column_name":"flow_category",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"npci_resp_code",
    "alias_column_name":"npci_resp_code",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"payee_handle",
    "alias_column_name":"payee_handle",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"payee_handle",
    "alias_column_name":"payee_psp",
    "source_or_derived":"derived",
    "derived_column_logic":"case when lower(payee_handle) in ('paytm','ptyes','ptaxis','pthdfc','ptsbi','ptybl','ptys','pty') then 'Payee as Paytm' else 'Payee as Others' end"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"payer_bank_name",
    "alias_column_name":"payer_bank_name",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"payer_handle",
    "alias_column_name":"payer_handle",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"payer_handle",
    "alias_column_name":"payer_psp",
    "source_or_derived":"derived",
    "derived_column_logic":"case when lower(payer_handle) in ('paytm','ptyes','ptaxis','pthdfc','ptsbi') then 'Payer as Paytm' else 'Payer as Others' end"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"purpose_code",
    "alias_column_name":"purpose_code",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"status",
    "alias_column_name":"status",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"transaction_date_key",
    "alias_column_name":"Day",
    "source_or_derived":"derived",
    "derived_column_logic":"Day(day_id)"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"transaction_date_key",
    "alias_column_name":"Month",
    "source_or_derived":"derived",
    "derived_column_logic":"date_trunc('month',day_id)"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"transaction_date_key",
    "alias_column_name":"day_id",
    "source_or_derived":"derived",
    "derived_column_logic":"transaction_date_key"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"transaction_date_key",
    "alias_column_name":"transaction_date_key",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"transaction_type",
    "alias_column_name":"transaction_type",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"txn_id",
    "alias_column_name":"SR",
    "source_or_derived":"derived",
    "derived_column_logic":"(count(txn_id) filter(where status in('DEEMED','SUCCESS'))*1.0000)\/(count(txn_id)*1.0000)"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"txn_id",
    "alias_column_name":"txn_id",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"txn_timestamp",
    "alias_column_name":"created_on",
    "source_or_derived":"derived",
    "derived_column_logic":"txn_timestamp"
  },
  {
    "tables_involved":"hive.cdo.fact_upi_transactions_snapshot_v3",
    "column_names":"txn_timestamp",
    "alias_column_name":"txn_timestamp",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  }
]