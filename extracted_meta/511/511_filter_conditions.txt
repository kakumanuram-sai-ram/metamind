## P2P P2M SR_511

This metric tracks the success rate (SR) of UPI transactions for Paytm ecosystem PSPs, measuring the percentage of transactions that achieve DEEMED or SUCCESS status out of total attempted transactions. The analysis is segmented between P2P (person-to-person via VPA2ACCOUNT, VPA2VPA) and P2M (person-to-merchant via VPA2MERCHANT) transaction flows. The metric filters for current month data, excludes purpose code 14 transactions, and focuses specifically on Paytm ecosystem payer handles (paytm, ptyes, ptaxis, pthdfc, ptsbi). This provides insights into transaction processing reliability and user experience quality across different payment flows within the Paytm PSP network, enabling performance monitoring and operational optimization.

-- tables_involved
cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for a different categorical value
--- data freshness filter for current analysis period
txn.dl_last_updated >= date_trunc('month', current_date - interval '1' day - interval '1' month) AND
--- transaction scope filter for payment flows only
txn.transaction_type IN ('PAY', 'COLLECT') AND
--- category filter for P2P and P2M flows
txn.category IN ('VPA2ACCOUNT', 'VPA2VPA', 'VPA2MERCHANT') AND
--- payer ecosystem filter for Paytm PSPs
lower(txn.payer_handle) IN ('paytm', 'ptyes', 'ptaxis', 'pthdfc', 'ptsbi')

--- specific filters
--- current month data filter for month-to-date analysis
txn.transaction_date_key >= date_trunc('month', current_date - interval '1' day) AND
--- exclude purpose code 14 transactions (likely specific merchant category exclusion)
txn.purpose_code != '14'

--- calculation_logic
(count(txn_id) filter(where status in('DEEMED','SUCCESS')) * 1.0000) / (count(txn_id) * 1.0000) as SR,
CASE WHEN category IN ('VPA2ACCOUNT','VPA2VPA') THEN 'P2P'
     WHEN category IN ('VPA2MERCHANT') THEN 'P2M'
     ELSE NULL END AS P2P_P2M




## Overall SR_511

Overall SR tracks the success rate of UPI transactions within the Paytm ecosystem, measuring the percentage of transactions that complete successfully (including both SUCCESS and DEEMED status) out of total transaction attempts. This metric provides daily granular visibility into transaction performance across the current month, helping monitor operational excellence and identify potential issues in payment processing. The analysis focuses on core UPI payment flows (P2P via VPA2ACCOUNT/VPA2VPA and P2M via VPA2MERCHANT) while excluding cash withdrawal transactions and limiting scope to transactions where Paytm ecosystem handles act as payers, providing insights into Paytm's transaction success performance.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for a different categorical value
--- limit to core UPI payment transaction types
txn.transaction_type IN ('PAY','COLLECT') AND
--- exclude cash withdrawal transactions
txn.purpose_code != '14' AND
--- focus on VPA-based transactions (P2P and P2M flows)
txn.category IN ('VPA2ACCOUNT','VPA2VPA','VPA2MERCHANT') AND
--- restrict to Paytm ecosystem as payer
lower(txn.payer_handle) IN ('paytm','ptyes','ptaxis','pthdfc','ptsbi') AND
--- ensure data freshness for current analysis period
txn.dl_last_updated >= date_trunc('month', current_date - interval '1' day - interval '1' month)

--- specific filters
--- analyze current month performance from previous day onwards
txn.day_id >= date_trunc('month', current_date - interval '1' day)

--- calculation_logic
count(txn_id) FILTER(WHERE status IN ('DEEMED','SUCCESS')) * 1.0000 / count(txn_id) * 1.0000 AS success_rate,
grouped by DAY(day_id), date_trunc('month', day_id)




## Overall SR_511

Overall SR tracks the success rate of UPI transactions within the Paytm ecosystem, measuring the percentage of transactions that complete successfully (including both SUCCESS and DEEMED status) out of total transaction attempts. This metric provides daily granular visibility into transaction performance across the current month, helping monitor operational excellence and identify potential issues in payment processing. The analysis focuses on core UPI payment flows (P2P via VPA2ACCOUNT/VPA2VPA and P2M via VPA2MERCHANT) while excluding cash withdrawal transactions and limiting scope to transactions where Paytm ecosystem handles act as payers, providing insights into Paytm's transaction success performance.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for a different categorical value
--- limit to core UPI payment transaction types
txn.transaction_type IN ('PAY','COLLECT') AND
--- exclude cash withdrawal transactions
txn.purpose_code != '14' AND
--- focus on VPA-based transactions (P2P and P2M flows)
txn.category IN ('VPA2ACCOUNT','VPA2VPA','VPA2MERCHANT') AND
--- restrict to Paytm ecosystem as payer
lower(txn.payer_handle) IN ('paytm','ptyes','ptaxis','pthdfc','ptsbi') AND
--- ensure data freshness for current analysis period
txn.dl_last_updated >= date_trunc('month', current_date - interval '1' day - interval '1' month)

--- specific filters
--- analyze current month performance from previous day onwards
txn.day_id >= date_trunc('month', current_date - interval '1' day)

--- calculation_logic
count(txn_id) FILTER(WHERE status IN ('DEEMED','SUCCESS')) * 1.0000 / count(txn_id) * 1.0000 AS success_rate,
grouped by DAY(day_id), date_trunc('month', day_id)




## P2P P2M SR_511

This metric tracks the success rate (SR) of UPI transactions for Paytm ecosystem PSPs, measuring the percentage of transactions that achieve DEEMED or SUCCESS status out of total attempted transactions. The analysis is segmented between P2P (person-to-person via VPA2ACCOUNT, VPA2VPA) and P2M (person-to-merchant via VPA2MERCHANT) transaction flows. The metric filters for current month data, excludes purpose code 14 transactions, and focuses specifically on Paytm ecosystem payer handles (paytm, ptyes, ptaxis, pthdfc, ptsbi). This provides insights into transaction processing reliability and user experience quality across different payment flows within the Paytm PSP network, enabling performance monitoring and operational optimization.

-- tables_involved
cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for a different categorical value
--- data freshness filter for current analysis period
txn.dl_last_updated >= date_trunc('month', current_date - interval '1' day - interval '1' month) AND
--- transaction scope filter for payment flows only
txn.transaction_type IN ('PAY', 'COLLECT') AND
--- category filter for P2P and P2M flows
txn.category IN ('VPA2ACCOUNT', 'VPA2VPA', 'VPA2MERCHANT') AND
--- payer ecosystem filter for Paytm PSPs
lower(txn.payer_handle) IN ('paytm', 'ptyes', 'ptaxis', 'pthdfc', 'ptsbi')

--- specific filters
--- current month data filter for month-to-date analysis
txn.transaction_date_key >= date_trunc('month', current_date - interval '1' day) AND
--- exclude purpose code 14 transactions (likely specific merchant category exclusion)
txn.purpose_code != '14'

--- calculation_logic
(count(txn_id) filter(where status in('DEEMED','SUCCESS')) * 1.0000) / (count(txn_id) * 1.0000) as SR,
CASE WHEN category IN ('VPA2ACCOUNT','VPA2VPA') THEN 'P2P'
     WHEN category IN ('VPA2MERCHANT') THEN 'P2M'
     ELSE NULL END AS P2P_P2M




## Category SR_511

This metric tracks the Success Rate (SR) for UPI transactions in Online, Onus, and Scan & Pay (SnP) flow categories, segmented by day of the month within the Paytm ecosystem. Success Rate is calculated as the percentage of transactions with DEEMED or SUCCESS status out of total transactions. The analysis focuses on transactions where the payer belongs to Paytm's partner PSPs (paytm, ptyes, ptaxis, pthdfc, ptsbi) and excludes P2P transactions to concentrate on merchant and online payment scenarios. Data is filtered to the current month starting from the first day, providing daily trend analysis for non-P2P transaction success rates across different payment flow categories within the Paytm ecosystem.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for different flow categories
--- restrict to current month data for trend analysis
txn.day_id >= date_trunc('month', current_date - interval '01' day) AND
--- include recent transaction data for up-to-date analysis
txn.dl_last_updated >= date_trunc('month', current_date - interval '01' day - interval '01' month) AND
--- focus on payment transactions only
txn.transaction_type IN ('PAY', 'COLLECT') AND
--- exclude P2P transactions to focus on merchant payments
txn.category IN ('VPA2ACCOUNT', 'VPA2VPA', 'VPA2MERCHANT') AND
--- limit to Paytm ecosystem payers
lower(txn.payer_handle) IN ('paytm', 'ptyes', 'ptaxis', 'pthdfc', 'ptsbi')

--- specific filters
--- focus on non-P2P flow categories for merchant payment analysis
txn.final_category IN ('Online', 'Onus', 'SnP')

--- calculation_logic
(count(txn_id) filter(where status in('DEEMED','SUCCESS')) * 1.0000) / (count(txn_id) * 1.0000) as SR




## Category SR_511

This metric tracks the Success Rate (SR) for UPI transactions in Online, Onus, and Scan & Pay (SnP) flow categories, segmented by day of the month within the Paytm ecosystem. Success Rate is calculated as the percentage of transactions with DEEMED or SUCCESS status out of total transactions. The analysis focuses on transactions where the payer belongs to Paytm's partner PSPs (paytm, ptyes, ptaxis, pthdfc, ptsbi) and excludes P2P transactions to concentrate on merchant and online payment scenarios. Data is filtered to the current month starting from the first day, providing daily trend analysis for non-P2P transaction success rates across different payment flow categories within the Paytm ecosystem.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for different flow categories
--- restrict to current month data for trend analysis
txn.day_id >= date_trunc('month', current_date - interval '01' day) AND
--- include recent transaction data for up-to-date analysis
txn.dl_last_updated >= date_trunc('month', current_date - interval '01' day - interval '01' month) AND
--- focus on payment transactions only
txn.transaction_type IN ('PAY', 'COLLECT') AND
--- exclude P2P transactions to focus on merchant payments
txn.category IN ('VPA2ACCOUNT', 'VPA2VPA', 'VPA2MERCHANT') AND
--- limit to Paytm ecosystem payers
lower(txn.payer_handle) IN ('paytm', 'ptyes', 'ptaxis', 'pthdfc', 'ptsbi')

--- specific filters
--- focus on non-P2P flow categories for merchant payment analysis
txn.final_category IN ('Online', 'Onus', 'SnP')

--- calculation_logic
(count(txn_id) filter(where status in('DEEMED','SUCCESS')) * 1.0000) / (count(txn_id) * 1.0000) as SR




## Handle SR_511

This metric tracks the Success Rate (SR) for UPI transactions segmented by payer PSP handles including ptyes (Yes Bank), ptaxis (Axis Bank), pthdfc (HDFC Bank), and ptsbi (SBI). The success rate is calculated as the ratio of successful transactions (those with DEEMED or SUCCESS status) to total transactions, providing insight into payment service provider performance. The metric filters for current month data and focuses on P2P, P2M transaction categories (VPA2ACCOUNT, VPA2VPA, VPA2MERCHANT) with PAY and COLLECT transaction types. This enables monitoring of partner PSP reliability and identifying performance variations across different banking partners for operational and business relationship management.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for a different categorical value
--- ensure data freshness for current analysis period
txn.dl_last_updated >= date_trunc('month', current_date - interval '1' day - interval '1' month) AND
--- limit to payment transactions only
txn.transaction_type IN ('PAY', 'COLLECT') AND
--- focus on core UPI transaction flows
txn.category IN ('VPA2ACCOUNT', 'VPA2VPA', 'VPA2MERCHANT')

--- specific filters
--- current month data for timely performance monitoring
txn.day_id >= date_trunc('month', current_date - interval '1' day) AND
--- segment by payer PSP for partner performance analysis
--- parameter values: ptyes (Yes Bank), ptaxis (Axis Bank), pthdfc (HDFC Bank), ptsbi (SBI)
txn.payer_handle IN ({payer_psp}: ptyes, ptaxis, pthdfc, ptsbi)

--- calculation_logic
(count(txn.txn_id) FILTER(WHERE txn.status IN ('DEEMED', 'SUCCESS')) * 1.0000) / (count(txn.txn_id) * 1.0000) AS success_rate




## Flowwise SR_511

This metric tracks the success rate of UPI transactions within the Paytm ecosystem, measuring the percentage of transactions that achieve 'SUCCESS' or 'DEEMED' status out of total transaction attempts. It segments performance by flow category (P2P, 3P QR, Paytm QR, Intent, P2M Collect, Mandate types) and day of month to identify patterns in transaction success across different payment methods and time periods. The analysis focuses specifically on transactions where Paytm acts as the payer PSP, excluding refund transactions (purpose code 14), and provides daily granular insights into operational performance for the current month to support real-time monitoring and troubleshooting efforts.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for different categorical values
--- restrict to current month transactions for real-time monitoring
txn.day_id >= date_trunc('month', current_date - interval '01' day) AND
--- focus on Paytm ecosystem as payer PSP
lower(txn.payer_handle) IN ('paytm','ptyes','ptaxis','pthdfc','ptsbi') AND
--- exclude refund transactions
txn.purpose_code != '14' AND
--- include only relevant transaction types
txn.transaction_type IN ('PAY','COLLECT') AND
--- focus on core UPI transaction categories
txn.category IN ('VPA2ACCOUNT','VPA2VPA','VPA2MERCHANT') AND
--- ensure data freshness for current analysis
txn.dl_last_updated >= date_trunc('month', current_date - interval '01' day - interval '01' month)

--- calculation_logic
(count(txn_id) filter(where status in('DEEMED','SUCCESS'))*1.0000) / (count(txn_id)*1.0000) as success_rate,
grouped by Day(day_id) and flow_category




## Handle SR_511

This metric tracks the Success Rate (SR) for UPI transactions segmented by payer PSP handles including ptyes (Yes Bank), ptaxis (Axis Bank), pthdfc (HDFC Bank), and ptsbi (SBI). The success rate is calculated as the ratio of successful transactions (those with DEEMED or SUCCESS status) to total transactions, providing insight into payment service provider performance. The metric filters for current month data and focuses on P2P, P2M transaction categories (VPA2ACCOUNT, VPA2VPA, VPA2MERCHANT) with PAY and COLLECT transaction types. This enables monitoring of partner PSP reliability and identifying performance variations across different banking partners for operational and business relationship management.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for a different categorical value
--- ensure data freshness for current analysis period
txn.dl_last_updated >= date_trunc('month', current_date - interval '1' day - interval '1' month) AND
--- limit to payment transactions only
txn.transaction_type IN ('PAY', 'COLLECT') AND
--- focus on core UPI transaction flows
txn.category IN ('VPA2ACCOUNT', 'VPA2VPA', 'VPA2MERCHANT')

--- specific filters
--- current month data for timely performance monitoring
txn.day_id >= date_trunc('month', current_date - interval '1' day) AND
--- segment by payer PSP for partner performance analysis
--- parameter values: ptyes (Yes Bank), ptaxis (Axis Bank), pthdfc (HDFC Bank), ptsbi (SBI)
txn.payer_handle IN ({payer_psp}: ptyes, ptaxis, pthdfc, ptsbi)

--- calculation_logic
(count(txn.txn_id) FILTER(WHERE txn.status IN ('DEEMED', 'SUCCESS')) * 1.0000) / (count(txn.txn_id) * 1.0000) AS success_rate




## Flowwise SR_511

This metric tracks the success rate of UPI transactions within the Paytm ecosystem, measuring the percentage of transactions that achieve 'SUCCESS' or 'DEEMED' status out of total transaction attempts. It segments performance by flow category (P2P, 3P QR, Paytm QR, Intent, P2M Collect, Mandate types) and day of month to identify patterns in transaction success across different payment methods and time periods. The analysis focuses specifically on transactions where Paytm acts as the payer PSP, excluding refund transactions (purpose code 14), and provides daily granular insights into operational performance for the current month to support real-time monitoring and troubleshooting efforts.

-- tables_involved
hive.cdo.fact_upi_transactions_snapshot_v3 txn

--- standard filters to be applied unless specifically requested for different categorical values
--- restrict to current month transactions for real-time monitoring
txn.day_id >= date_trunc('month', current_date - interval '01' day) AND
--- focus on Paytm ecosystem as payer PSP
lower(txn.payer_handle) IN ('paytm','ptyes','ptaxis','pthdfc','ptsbi') AND
--- exclude refund transactions
txn.purpose_code != '14' AND
--- include only relevant transaction types
txn.transaction_type IN ('PAY','COLLECT') AND
--- focus on core UPI transaction categories
txn.category IN ('VPA2ACCOUNT','VPA2VPA','VPA2MERCHANT') AND
--- ensure data freshness for current analysis
txn.dl_last_updated >= date_trunc('month', current_date - interval '01' day - interval '01' month)

--- calculation_logic
(count(txn_id) filter(where status in('DEEMED','SUCCESS'))*1.0000) / (count(txn_id)*1.0000) as success_rate,
grouped by Day(day_id) and flow_category



