tables_involved,column_names,alias_column_name,source_or_derived,derived_column_logic,column_datatype,extra,comment
hive.cdo.fact_upi_transactions_snapshot_v3,amount,amount,source,,double,,
hive.cdo.fact_upi_transactions_snapshot_v3,app_resp_code,app_resp_code,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,category,category,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id_payer,customer_id_payer,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,customer_id_payer,payer_cust_id,derived,customer_id_payer,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,dl_last_updated,dl_last_updated,source,,date,,
hive.cdo.fact_upi_transactions_snapshot_v3,flow_category,final_Category,derived,"CASE WHEN flow_category IN ('P2P') THEN 'P2P' WHEN flow_category IN ('3P QR', 'Paytm QR') THEN 'SnP' WHEN flow_category IN ('Intent', 'P2M Collect','Mandate_Online') THEN 'Online' WHEN flow_category IN ('Onus_ExcMandates','Mandate_Onus') THEN 'Onus' ELSE 'Others' END",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,flow_category,flow_category,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,npci_resp_code,npci_resp_code,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payee_bank_name,payee_bank_name,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payee_handle,payee_handle,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payer_account_type,payer_account_type,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payer_bank_name,payer_bank_name,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,payer_handle,payer_handle,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,purpose_code,purpose_code,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,status,status,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,status,success_Txns,derived,case when status ='SUCCESS' then txn_id end,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,total_L7D_failures,Last 7 Day avg,derived,"sum(""total_L7D_failures"")",,,
hive.cdo.fact_upi_transactions_snapshot_v3,total_yest_failures,% Change(Yest vs L7D Avg),derived,(sum(total_yest_failures*1.0000)/sum(total_L7D_failures*1.000) -1),,,
hive.cdo.fact_upi_transactions_snapshot_v3,total_yest_failures,Yesterday's Failure,derived,sum(total_yest_failures),,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_date_key,transaction_date_key,source,,date,,
hive.cdo.fact_upi_transactions_snapshot_v3,transaction_type,transaction_type,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,% Change(Yest vs L7D Avg),derived,(sum(total_yest_failures*1.0000)/sum(total_L7D_failures*1.000) -1),varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,Change Yday vs last 7 day avg,derived,(COUNT(txn_id) filter(WHERE status = 'FAILURE' and period = 'Yday')*1.0000)/(COUNT(txn_id) filter(WHERE status = 'FAILURE' and period = 'last7day')*1.0000/7)-1,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,Last 7 Day avg,derived,"sum(""total_L7D_failures"")",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,Last7day Failure,derived,COUNT(txn_id) filter(WHERE status = 'FAILURE' and period = 'last7day')/7,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,Last_7D_AVG_failures,derived,"count(distinct case when date(created_on) between DATE_ADD('day', -8, CURRENT_DATE) and DATE_ADD('day', -2, CURRENT_DATE) then txn_id end)/7",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,Yesterday's Failure,derived,COUNT(txn_id) filter(WHERE status = 'FAILURE' and period = 'Yday'),varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,rn,derived,"ROW_NUMBER() OVER (ORDER BY SUM(yest_failures) DESC, SUM(Last_7D_AVG_failures) DESC)",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,success_Txns,derived,case when status ='SUCCESS' then txn_id end,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,total_L7D_failures,derived,SUM(bf.Last_7D_AVG_failures),varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,total_yest_failures,derived,SUM(bf.yest_failures),varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,txn_id,source,,varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_id,yest_failures,derived,"count(distinct case when date(created_on) = DATE_ADD('day', -1, CURRENT_DATE) then txn_id end)",varchar,,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,created_on,derived,txn_timestamp,timestamp(3),,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,dt,derived,date(txn_timestamp),timestamp(3),,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,period,derived,case when date(txn_timestamp) = (current_date - interval '01' day) then 'Yday' when date(txn_timestamp) between (current_date - interval '08' day) and (current_date - interval '02' day) then 'last7day' end,timestamp(3),,
hive.cdo.fact_upi_transactions_snapshot_v3,txn_timestamp,txn_timestamp,source,,timestamp(3),,
hive.switch.txn_info_snapshot_v3,Error_code,error_code,derived,"coalesce(npci_resp_code,app_resp_code)",,,
hive.switch.txn_info_snapshot_v3,account_type,account_type,source,,,,
hive.switch.txn_info_snapshot_v3,amount,amount,source,,"decimal(10,2)",,
hive.switch.txn_info_snapshot_v3,app_resp_code,app_resp_code,source,,varchar,,
hive.switch.txn_info_snapshot_v3,app_resp_code,error_code,derived,"coalesce(ti.npci_resp_code,ti.app_resp_code)",varchar,,
hive.switch.txn_info_snapshot_v3,bank_code,bank_code,source,,,,
hive.switch.txn_info_snapshot_v3,business_type,business_type,source,,varchar,,
hive.switch.txn_info_snapshot_v3,category,category,source,,varchar,,
hive.switch.txn_info_snapshot_v3,category,final_Category,derived,"case when flow_cat IN ('P2P') THEN 'P2P' WHEN flow_cat IN ('3P QR', 'Paytm QR') THEN 'SnP' WHEN flow_cat IN ('Intent', 'P2M Collect') or (flow_cat = 'MANDATE' and c.onus_vpa is null) THEN 'Online' WHEN flow_cat IN ('Onus_ExcMandates','Mandate_Onus') or(flow_cat = 'MANDATE' and c.onus_vpa is not null) THEN 'Onus' else flow_cat end",varchar,,
hive.switch.txn_info_snapshot_v3,category,flow_cat,derived,"case when (category= 'VPA2MERCHANT') and business_type = 'MANDATE' then 'MANDATE' when category in ('VPA2VPA','VPA2ACCOUNT') and (business_type is null or business_type <> 'MANDATE') then 'P2P' when type = 'PAY' and category = 'VPA2MERCHANT' and upper(channel_code) = 'PAYTM_QR_MERCHANTS' then 'Paytm QR' when type = 'PAY' and category = 'VPA2MERCHANT' and upper(channel_code) = 'PAYTM' and JSON_EXTRACT_SCALAR(extended_info, '$.initiationMode') in ('00','01','15','22','23') then '3P QR' when type = 'COLLECT' and category = 'VPA2MERCHANT' and (business_type is null or business_type <> 'MANDATE') then 'P2M Collect' when type = 'PAY' and category = 'VPA2MERCHANT' and upper(channel_code) = 'PAYTM' and JSON_EXTRACT_SCALAR(extended_info, '$.initiationMode') in ('04','03') then 'Intent' when type = 'PAY' and category = 'VPA2MERCHANT' and upper(channel_code) in ('ONLINE_3P_NATIVE') then 'Intent' when type = 'PAY' and category = 'VPA2MERCHANT' and upper(channel_code) in ('ONLINE_ONUS_NATIVE') then 'Onus_ExcMandates' when type = 'PAY' and category = 'VPA2MERCHANT' then 'Other P2M' else 'Others' end",varchar,,
hive.switch.txn_info_snapshot_v3,channel_code,channel_code,source,,varchar,,
hive.switch.txn_info_snapshot_v3,created_on,Hour,derived,hour(created_on),timestamp(3),,
hive.switch.txn_info_snapshot_v3,created_on,Time_,derived,"date_trunc('hour',created_on)",timestamp(3),,
hive.switch.txn_info_snapshot_v3,created_on,created_on,source,,timestamp(3),,
hive.switch.txn_info_snapshot_v3,created_on,current_time_,derived,(select (max(created_on) - interval '10' minute) last_time from hive.switch.txn_info_snapshot_v3 where dl_last_updated = current_date),timestamp(3),,
hive.switch.txn_info_snapshot_v3,created_on,date_time_hourly,derived,"date_Trunc('hour',created_on)",timestamp(3),,
hive.switch.txn_info_snapshot_v3,created_on,day_id,derived,date(created_on),timestamp(3),,
hive.switch.txn_info_snapshot_v3,created_on,dt,derived,date(created_on),timestamp(3),,
hive.switch.txn_info_snapshot_v3,dl_last_updated,dl_last_updated,source,,date,,
hive.switch.txn_info_snapshot_v3,error_code,error_code,source,,,,
hive.switch.txn_info_snapshot_v3,extended_info,extended_info,source,,varchar,,
hive.switch.txn_info_snapshot_v3,handle,handle,source,,,,
hive.switch.txn_info_snapshot_v3,merchant_vpa,merchant_vpa,source,,,,
hive.switch.txn_info_snapshot_v3,npci_resp_code,Error_code,derived,"coalesce(npci_resp_code,app_resp_code)",varchar,,
hive.switch.txn_info_snapshot_v3,npci_resp_code,error_code,derived,"coalesce(ti.npci_resp_code,ti.app_resp_code)",varchar,,
hive.switch.txn_info_snapshot_v3,npci_resp_code,npci_resp_code,source,,varchar,,
hive.switch.txn_info_snapshot_v3,participant_type,participant_type,source,,,,
hive.switch.txn_info_snapshot_v3,payee_vpa,payee_vpa,source,,,,
hive.switch.txn_info_snapshot_v3,payer_handle,payer_handle,source,,,,
hive.switch.txn_info_snapshot_v3,psp_handle,psp_handle,source,,varchar,,
hive.switch.txn_info_snapshot_v3,scope_cust_id,scope_cust_id,source,,,,
hive.switch.txn_info_snapshot_v3,status,status,source,,varchar,,
hive.switch.txn_info_snapshot_v3,total_today_failures,Failure Growth,derived,sum(total_today_failures*1.0000)/sum(total_yest_failures*1.0000)-1,,,
hive.switch.txn_info_snapshot_v3,total_today_failures,Today Failure,derived,sum(total_today_failures),,,
hive.switch.txn_info_snapshot_v3,total_today_failures,Today's Failure,derived,sum(total_today_failures),,,
hive.switch.txn_info_snapshot_v3,total_today_failures,rn,derived,"ROW_NUMBER() OVER (ORDER BY SUM(n_today_failures) DESC, SUM(n_yest_failures) DESC)",,,
hive.switch.txn_info_snapshot_v3,total_today_failures,total_today_failures,source,,,,
hive.switch.txn_info_snapshot_v3,total_yest_failures,Growth,derived,case when sum(total_yest_failures)  = 0 then 0 else (sum(total_today_failures) *1.0000)/(sum(total_yest_failures) *1.0000)-1 end,,,
hive.switch.txn_info_snapshot_v3,total_yest_failures,Yday Failure,derived,sum(total_yest_failures),,,
hive.switch.txn_info_snapshot_v3,total_yest_failures,Yesterday's Failure,derived,sum(total_yest_failures),,,
hive.switch.txn_info_snapshot_v3,total_yest_failures,total_yest_failures,source,,,,
hive.switch.txn_info_snapshot_v3,txn_id,Failed_txns,derived,sum(txns) filter(where status in('FAILURE')),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,Failure Growth,derived,case when COUNT(txn_id)filter(where date(created_on) = (date(current_time_) - interval '01' day) and hour(created_on) <= hour((current_time_ - interval '01' hour))) = 0 then 0 else (COUNT(txn_id)filter(where date(created_on) = date(current_time_) and hour(created_on) <= hour((current_time_ - interval '01' hour)))*1.0000)/(COUNT(txn_id)filter(where date(created_on) = (date(current_time_)- interval '01' day) and hour(created_on) <= hour((current_time_ - interval '01' hour)))*1.0000)-1 end,varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,Failure_Growth,derived,((todays_txns*1.0000)/(yesterdays_txns*1.0000)-1),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,Pending_txns,derived,sum(txns) filter(where status in('PENDING')),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,SR,derived,(COUNT(txn_id) filter(WHERE status = 'SUCCESS')*1.0000) / (COUNT(txn_id)*1.0000),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,Success_txns,derived,"sum(txns) filter(where status in('SUCCESS','DEEMED'))",varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,Today Failure,derived,COUNT(txn_id)filter(where date(created_on) = date(current_time_) and hour(created_on) <= hour((current_time_ - interval '01' hour))),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,Today_Failure,derived,COUNT(txn_id) filter(where date(created_on) = (date(current_time_)) and hour(created_on) <= hour((cast(current_time_ as TIMESTAMP) - interval '01' hour))),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,YDay_Failure,derived,COUNT(txn_id)filter(where date(created_on) = (date(current_time_)- interval '01' day) and hour(created_on) <= hour((cast(current_time_ as TIMESTAMP) - interval '01' hour))),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,Yday Failure,derived,COUNT(txn_id)filter(where date(created_on) = (date(current_time_)- interval '01' day) and hour(created_on) <= hour((current_time_ - interval '01' hour))),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,n_today_failures,derived,count(txn_id) filter(where date(created_on) = (current_date)),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,n_yest_failures,derived,count(txn_id) filter(where date(created_on) = (current_date - interval '01' day)),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,todays_txns,derived,sum(txns) filter(WHERE day_id = current_Date),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,total_Txn,derived,sum(txns),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,total_today_failures,derived,SUM(bf.n_today_failures),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,total_yest_failures,derived,SUM(bf.n_yest_failures),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,txn_id,source,,varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,txns,derived,count(txn_id),varchar,,
hive.switch.txn_info_snapshot_v3,txn_id,yesterdays_txns,derived,sum(txns) filter(WHERE day_id = current_Date - interval '01' day),varchar,,
hive.switch.txn_info_snapshot_v3,type,type,source,,varchar,,
hive.switch.txn_info_snapshot_v3,vpa,vpa,source,,,,
hive.switch.txn_participants_snapshot_v3,account_type,account_type,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,account_type,payer_account_type,derived,account_type,varchar,,
hive.switch.txn_participants_snapshot_v3,amount,amount,source,,"decimal(10,2)",,
hive.switch.txn_participants_snapshot_v3,app_resp_code,app_resp_code,source,,,,
hive.switch.txn_participants_snapshot_v3,bank_code,bank_code,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,bank_code,payee_bank,derived,bank_code,varchar,,
hive.switch.txn_participants_snapshot_v3,bank_code,payer_bank,derived,bank_code,varchar,,
hive.switch.txn_participants_snapshot_v3,business_type,business_type,source,,,,
hive.switch.txn_participants_snapshot_v3,category,category,source,,,,
hive.switch.txn_participants_snapshot_v3,channel_code,channel_code,source,,,,
hive.switch.txn_participants_snapshot_v3,created_on,created_on,source,,timestamp(3),,
hive.switch.txn_participants_snapshot_v3,dl_last_updated,dl_last_updated,source,,date,,
hive.switch.txn_participants_snapshot_v3,error_code,error_code,source,,,,
hive.switch.txn_participants_snapshot_v3,extended_info,extended_info,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,handle,handle,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,handle,payee_handle,derived,handle,varchar,,
hive.switch.txn_participants_snapshot_v3,handle,payer_handle,derived,handle,varchar,,
hive.switch.txn_participants_snapshot_v3,merchant_vpa,merchant_vpa,source,,,,
hive.switch.txn_participants_snapshot_v3,npci_resp_code,npci_resp_code,source,,,,
hive.switch.txn_participants_snapshot_v3,participant_type,participant_type,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,payee_vpa,payee_vpa,source,,,,
hive.switch.txn_participants_snapshot_v3,payer_handle,payer_handle,source,,,,
hive.switch.txn_participants_snapshot_v3,psp_handle,psp_handle,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,scope_cust_id,payer_cust_id,derived,scope_cust_id,varchar,,
hive.switch.txn_participants_snapshot_v3,scope_cust_id,scope_cust_id,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,status,status,source,,,,
hive.switch.txn_participants_snapshot_v3,total_today_failures,total_today_failures,source,,,,
hive.switch.txn_participants_snapshot_v3,total_yest_failures,total_yest_failures,source,,,,
hive.switch.txn_participants_snapshot_v3,txn_id,txn_id,source,,varchar,,
hive.switch.txn_participants_snapshot_v3,type,type,source,,,,
hive.switch.txn_participants_snapshot_v3,vpa,payee_vpa,derived,vpa,varchar,,
hive.switch.txn_participants_snapshot_v3,vpa,payer_vpa,derived,vpa,varchar,,
hive.switch.txn_participants_snapshot_v3,vpa,vpa,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,businesstype,businesstype,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,category,category,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,dl_last_updated,dl_last_updated,source,,date,,
hive.upi_txn.upi_activities_data_snapshot_v3,hour,hour,source,,,,
hive.upi_txn.upi_activities_data_snapshot_v3,participant_type,participant_type,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,payer_vpa,payer_vpa,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,sr_avg,sr_avg,source,,,,
hive.upi_txn.upi_activities_data_snapshot_v3,status,status,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,txn_id,sr_current,derived,"CAST(COUNT(DISTINCT CASE WHEN LOWER(status) IN ('success','deemed') THEN txn_id END) AS DOUBLE) / CAST(COUNT(DISTINCT txn_id) AS DOUBLE)",varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,txn_id,txn_id,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,txn_timestamp,hour,derived,HOUR(CAST(txn_timestamp AS TIMESTAMP)),varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,txn_timestamp,txn_timestamp,source,,varchar,,
hive.upi_txn.upi_activities_data_snapshot_v3,type,type,source,,varchar,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,QR_FLAG,QR_FLAG,source,,,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,category,category,source,,varchar,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,dt,dt,source,,date,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,hr,hr,source,,bigint,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,mandate_flag,mandate_flag,source,,integer,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,payee_,payee_,source,,varchar(12),,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,payer_,payer_,source,,varchar(9),,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,resp_code,resp_code,source,,varchar,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,response_constant,response_constant,source,,varchar,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,status,status,source,,varchar(7),,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,txns,% Change SR,derived,"(((sum(txns)filter(where status in('SUCCESS','DEEMED'))*1.0000)/(sum(txns)*1.0000))*100)-(lag(((sum(txns)filter(where status in('SUCCESS','DEEMED'))*1.0000)/(sum(txns)*1.0000))*100) over(partition by hr, payee_ order by date_trunc('day', CAST(dt AS TIMESTAMP))))",bigint,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,txns,SR,derived,"((sum(txns)filter(where status in('SUCCESS','DEEMED'))*1.0000)/(sum(txns)*1.0000))*100",bigint,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,txns,Success Txns,derived,"sum(txns)filter(where status in('SUCCESS','DEEMED'))",bigint,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,txns,Total Txn,derived,sum(txns),bigint,,
hive.user_paytm_payments.T_vs_T1_Paytm_N_Competition_SR,txns,txns,source,,bigint,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,businesstype,businesstype,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,category,category,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,dl_last_updated,dl_last_updated,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,hour,hour,source,,bigint,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,participant_type,participant_type,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,payer_vpa,payer_vpa,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,sr_avg,sr_avg,source,,double,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,sr_avg,sr_difference,derived,cast(cs.sr_current as double)- cast(sb.sr_avg as double),double,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,status,status,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,txn_id,txn_id,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,txn_timestamp,txn_timestamp,source,,,,
hive.user_paytm_payments.feb_hourly_sr_benchamrk,type,type,source,,,,
hive.user_paytm_payments.onus_vpa_base,account_type,account_type,source,,,,
hive.user_paytm_payments.onus_vpa_base,amount,amount,source,,,,
hive.user_paytm_payments.onus_vpa_base,app_resp_code,app_resp_code,source,,,,
hive.user_paytm_payments.onus_vpa_base,bank_code,bank_code,source,,,,
hive.user_paytm_payments.onus_vpa_base,business_type,business_type,source,,,,
hive.user_paytm_payments.onus_vpa_base,category,category,source,,,,
hive.user_paytm_payments.onus_vpa_base,channel_code,channel_code,source,,,,
hive.user_paytm_payments.onus_vpa_base,created_on,created_on,source,,,,
hive.user_paytm_payments.onus_vpa_base,dl_last_updated,dl_last_updated,source,,,,
hive.user_paytm_payments.onus_vpa_base,error_code,error_code,source,,,,
hive.user_paytm_payments.onus_vpa_base,extended_info,extended_info,source,,,,
hive.user_paytm_payments.onus_vpa_base,handle,handle,source,,,,
hive.user_paytm_payments.onus_vpa_base,merchant_vpa,merchant_vpa,source,,varchar,,
hive.user_paytm_payments.onus_vpa_base,merchant_vpa,onus_vpa,derived,lower(merchant_vpa),varchar,,
hive.user_paytm_payments.onus_vpa_base,npci_resp_code,npci_resp_code,source,,,,
hive.user_paytm_payments.onus_vpa_base,participant_type,participant_type,source,,,,
hive.user_paytm_payments.onus_vpa_base,payee_vpa,payee_vpa,source,,,,
hive.user_paytm_payments.onus_vpa_base,payer_handle,payer_handle,source,,,,
hive.user_paytm_payments.onus_vpa_base,psp_handle,psp_handle,source,,,,
hive.user_paytm_payments.onus_vpa_base,scope_cust_id,scope_cust_id,source,,,,
hive.user_paytm_payments.onus_vpa_base,status,status,source,,,,
hive.user_paytm_payments.onus_vpa_base,total_today_failures,total_today_failures,source,,,,
hive.user_paytm_payments.onus_vpa_base,total_yest_failures,total_yest_failures,source,,,,
hive.user_paytm_payments.onus_vpa_base,txn_id,txn_id,source,,,,
hive.user_paytm_payments.onus_vpa_base,type,type,source,,,,
hive.user_paytm_payments.onus_vpa_base,vpa,vpa,source,,,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,Overall_txn,Overall_txn,source,,,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,Overall_txn,Total Txn,derived,"sum(""Overall_txn"")",,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,dt,dt,source,,date,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,hr,hr,source,,bigint,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,payer_,payer_,source,,varchar(9),,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,success,% Change SR,derived,"((
sum(success) *1.0000
)/(
sum(Overall_txn)*1.0000)
*100)
-
(
lag(
(
sum(success) *1.0000
)/(
sum(Overall_txn)*1.0000)
*100
) over(
partition by hr, payer_ order by date_trunc('day', CAST(dt AS TIMESTAMP))
)
)",bigint,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,success,SR,derived,"(
sum(success) *1.0000
)/(
sum(Overall_txn)*1.0000)
*100",bigint,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,success,Success Txns,derived,sum(success),bigint,,
hive.user_paytm_payments.t1_vs_t2_competition_to_paytm_sr,success,success,source,,bigint,,
