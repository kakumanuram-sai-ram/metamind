tables_involved,column_names,alias_column_name,source_or_derived,derived_column_logic,column_datatype,extra,comment
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,created_on,created_on,source,,timestamp(3),,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,hour_,hour_,source,,bigint,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,hour_,hour___,derived,hour_,bigint,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,lastest_hour,lastest_hour,source,,bigint,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,payee_handle,payee_handle,source,,varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,payer_handle,Payer PsP,derived,"case when lower(payer_handle) in('paytm','ptyes','ptaxis','pthdfc','ptsbi') then 'Payer = Paytm' else 'Payer = Other' End",varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,payer_handle,payer_handle,source,,varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,txn_id,Last month same day Txns,derived,COUNT(txn_id)filter(where date(created_on) = (current_Date - interval '01' month)),varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,txn_id,Today vs Last month Same Day,derived,case when (COUNT(txn_id)filter(where date(created_on) = (current_Date))*1.0000)  = 0 then null else (COUNT(txn_id)filter(where date(created_on) = (current_Date))*1.0000) / (COUNT(txn_id)filter(where date(created_on) = (current_Date - interval '01' month))*1.0000) - 1 end,varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,txn_id,Todays Txns,derived,COUNT(txn_id)filter(where date(created_on) = (current_Date)),varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,txn_id,Yesterdays Txns,derived,COUNT(txn_id)filter(where date(created_on) = (current_Date - interval '01' day)),varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,txn_id,today Vs Yesterday,derived,case when (COUNT(txn_id)filter(where date(created_on) = (current_Date))*1.0000) = 0 then null else (COUNT(txn_id)filter(where date(created_on) = (current_Date))*1.0000) / (COUNT(txn_id)filter(where date(created_on) = (current_Date - interval '01' day))*1.0000) - 1 end,varchar,,
hive.user_paytm_payments.p2p_inward_hourly_reporting_dataset,txn_id,txn_id,source,,varchar,,
