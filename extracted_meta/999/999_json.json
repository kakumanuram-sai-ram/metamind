{
  "dashboard_id": 999,
  "dashboard_title": "DOD_GMV_Chargeable",
  "dashboard_url": "https://cdp-dataview.platform.mypaytm.com/superset/dashboard/999/",
  "owner": "Unknown",
  "created_on": "",
  "changed_on": "2025-11-04T11:13:02.478248",
  "charts": [
    {
      "chart_id": 4838,
      "chart_name": "DOD_GMV",
      "chart_type": "pivot_table_v2",
      "dataset_id": 2120,
      "dataset_name": "DOD_GMV_SB",
      "database_name": "Trino",
      "sql_query": "SELECT \"Days\" AS \"Days\", SUM(TOTAL_GMV)/1e7 AS \"Total GMV(in Cr)\", SUM((CC_GMV)+(DC_GMV)+(EMI_GMV)+(UPI_CC_GMV)+(CS70_UPI_CC_GMV))/1e7 AS \"CARD_GMV\", SUM(AGG_GMV_EXCLUDING_UPI)/1e7 AS \"Chargeable GMV (in Cr)\", ((SUM(AGG_GMV_EXCLUDING_UPI)) / (SUM(CC_GMV+DC_GMV+EMI_GMV+UPI_CC_GMV+CS70_UPI_CC_GMV)))*100 AS \"Chargeable %\" \nFROM (WITH CTE AS (\nselect DATE(dt) dt,\nCASE WHEN UPPER(COALESCE(transaction_bank_settled,'FALSE')) IN ('TRUE') THEN 'POS' ELSE 'AGG' END POSPROVIDER_FLAG,\ncase\nwhen lower(requesttype) = 'edc' and lower(payment_mode) = 'credit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'CREDIT_CARD'\nwhen lower(requesttype) = 'edc' and lower(payment_mode) = 'debit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'DEBIT_CARD'\nwhen final_emitype  in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') then'EMI'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'UPI_CC'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'UPI'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'CS70_UPI_CC'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'CS70_UPI'\nELSE 'OTHERS' END AS Final_payment_mode,\nsum(gtv + coalesce(gtv_ad,0)) as EDC_GMV, sum(pg_comm+coalesce(pg_comm_ad,0)) mdr\nfrom cdo.business_edc_txn_base_snapshot_v3\nwhere gtv/txn>1\nand device_serial_no is not null\nand date(dt) >=date_trunc('month',current_date - interval '1' day) and dl_last_updated >=date_trunc('month',current_date - interval '1' day)\nand lower(mid) in (select distinct lower(mid)\nfrom cdo.edc_final_business_base_snapshot_v3 t1\nleft join user_paytm_payments.offline_channel_mapping_for_ra ra\non lower(t1.mid) = lower(ra.pg_mid)\nwhere length(trim(t1.device_serial_no))<16\nand upper(ra.channel) in ('SEMI ORGANISED','BANKING','ONLINE','RETAIL_EDC','RETAIL_MM')) group by 1,2,3)\n\nSELECT DAY(DT) AS Days,\nSUM(COALESCE(EDC_GMV,0)) AS TOTAL_GMV,\nSUM(case when final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS CC_GMV,\nSUM(case when final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS DC_GMV,\nSUM(case when final_payment_mode = 'EMI' THEN  COALESCE(EDC_GMV,0) END) AS EMI_GMV,\nSUM(case when final_payment_mode = 'UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS UPI_CC_GMV,\nSUM(case when final_payment_mode = 'UPI' THEN  COALESCE(EDC_GMV,0) END) AS UPI_GMV,\nSUM(case when final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS CS70_UPI_CC_GMV,\nSUM(case when final_payment_mode = 'CS70_UPI' THEN  COALESCE(EDC_GMV,0) END) AS CS70_UPI_GMV,\nSUM(case when final_payment_mode = 'OTHERS' THEN  COALESCE(EDC_GMV,0) END) AS REST_GMV,\nSUM(COALESCE(MDR,0)) AS TOTAL_REVENUE,\nSUM(case when final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(MDR,0) END) AS CC_MDR,\nSUM(case when final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(MDR,0) END) AS DC_MDR,\nSUM(case when final_payment_mode = 'EMI' THEN  COALESCE(MDR,0) END) AS EMI_MDR,\nSUM(case when final_payment_mode = 'UPI_CC' THEN  COALESCE(MDR,0) END) AS UPI_CC_MDR,\nSUM(case when final_payment_mode = 'UPI' THEN  COALESCE(MDR,0) END) AS UPI_MDR,\nSUM(case when final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(MDR,0) END) AS CS70_UPI_CC_MDR,\nSUM(case when final_payment_mode = 'CS70_UPI' THEN  COALESCE(MDR,0) END) AS CS70_UPI_MDR,\nSUM(CASE WHEN POSPROVIDER_FLAG = 'AGG' THEN COALESCE(EDC_GMV,0) END) AS AGG_GMV,\nSUM(CASE WHEN POSPROVIDER_FLAG = 'AGG' AND FINAL_PAYMENT_MODE NOT IN ('UPI','CS70_UPI') THEN COALESCE(EDC_GMV,0) END) AS AGG_GMV_EXCLUDING_UPI,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS AGG_CC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS AGG_DC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'EMI' THEN  COALESCE(EDC_GMV,0) END) AS AGG_EMI_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS AGG_UPI_CC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'UPI' THEN  COALESCE(EDC_GMV,0) END) AS AGG_UPI_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS AGG_CS70_UPI_CC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'CS70_UPI' THEN  COALESCE(EDC_GMV,0) END) AS AGG_CS70_UPI_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'OTHERS' THEN  COALESCE(EDC_GMV,0) END) AS AGG_REST_GMV\nFROM CTE\nGROUP BY 1\nORDER BY  DAYS\n) AS virtual_table GROUP BY \"Days\" ORDER BY \"Total GMV(in Cr)\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Total GMV(in Cr)",
          "optionName": "metric_uqoqdqcuk1_h1fn037h6fa",
          "sqlExpression": "SUM(TOTAL_GMV)/1e7"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "CARD_GMV",
          "optionName": "metric_5pef2ulkda9_ii1eofb0w",
          "sqlExpression": "SUM((CC_GMV)+(DC_GMV)+(EMI_GMV)+(UPI_CC_GMV)+(CS70_UPI_CC_GMV))/1e7"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Chargeable GMV (in Cr)",
          "optionName": "metric_518i7vahxkr_6d26incdow3",
          "sqlExpression": "SUM(AGG_GMV_EXCLUDING_UPI)/1e7"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Chargeable %",
          "optionName": "metric_ejddo8xbh_qnlriqnfmil",
          "sqlExpression": "((SUM(AGG_GMV_EXCLUDING_UPI)) / (SUM(CC_GMV+DC_GMV+EMI_GMV+UPI_CC_GMV+CS70_UPI_CC_GMV)))*100"
        }
      ],
      "columns": [
        "Days",
        "TOTAL_GMV",
        "CC_GMV",
        "DC_GMV",
        "EMI_GMV",
        "UPI_CC_GMV",
        "UPI_GMV",
        "CS70_UPI_CC_GMV",
        "CS70_UPI_GMV",
        "REST_GMV",
        "TOTAL_REVENUE",
        "CC_MDR",
        "DC_MDR",
        "EMI_MDR",
        "UPI_CC_MDR",
        "UPI_MDR",
        "CS70_UPI_CC_MDR",
        "CS70_UPI_MDR",
        "AGG_GMV",
        "AGG_GMV_EXCLUDING_UPI",
        "AGG_CC_GMV",
        "AGG_DC_GMV",
        "AGG_EMI_GMV",
        "AGG_UPI_CC_GMV",
        "AGG_UPI_GMV",
        "AGG_CS70_UPI_CC_GMV",
        "AGG_CS70_UPI_GMV",
        "AGG_REST_GMV"
      ],
      "groupby_columns": [],
      "filters": [],
      "time_range": null
    },
    {
      "chart_id": 4838,
      "chart_name": "DOD_GMV",
      "chart_type": "pivot_table_v2",
      "dataset_id": 2120,
      "dataset_name": "DOD_GMV_SB",
      "database_name": "Trino",
      "sql_query": "SELECT \"Days\" AS \"Days\", SUM(TOTAL_GMV)/1e7 AS \"Total GMV(in Cr)\", SUM((CC_GMV)+(DC_GMV)+(EMI_GMV)+(UPI_CC_GMV)+(CS70_UPI_CC_GMV))/1e7 AS \"CARD_GMV\", SUM(AGG_GMV_EXCLUDING_UPI)/1e7 AS \"Chargeable GMV (in Cr)\", ((SUM(AGG_GMV_EXCLUDING_UPI)) / (SUM(CC_GMV+DC_GMV+EMI_GMV+UPI_CC_GMV+CS70_UPI_CC_GMV)))*100 AS \"Chargeable %\" \nFROM (WITH CTE AS (\nselect DATE(dt) dt,\nCASE WHEN UPPER(COALESCE(transaction_bank_settled,'FALSE')) IN ('TRUE') THEN 'POS' ELSE 'AGG' END POSPROVIDER_FLAG,\ncase\nwhen lower(requesttype) = 'edc' and lower(payment_mode) = 'credit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'CREDIT_CARD'\nwhen lower(requesttype) = 'edc' and lower(payment_mode) = 'debit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'DEBIT_CARD'\nwhen final_emitype  in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') then'EMI'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'UPI_CC'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'UPI'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'CS70_UPI_CC'\nwhen final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'CS70_UPI'\nELSE 'OTHERS' END AS Final_payment_mode,\nsum(gtv + coalesce(gtv_ad,0)) as EDC_GMV, sum(pg_comm+coalesce(pg_comm_ad,0)) mdr\nfrom cdo.business_edc_txn_base_snapshot_v3\nwhere gtv/txn>1\nand device_serial_no is not null\nand date(dt) >=date_trunc('month',current_date - interval '1' day) and dl_last_updated >=date_trunc('month',current_date - interval '1' day)\nand lower(mid) in (select distinct lower(mid)\nfrom cdo.edc_final_business_base_snapshot_v3 t1\nleft join user_paytm_payments.offline_channel_mapping_for_ra ra\non lower(t1.mid) = lower(ra.pg_mid)\nwhere length(trim(t1.device_serial_no))<16\nand upper(ra.channel) in ('SEMI ORGANISED','BANKING','ONLINE','RETAIL_EDC','RETAIL_MM')) group by 1,2,3)\n\nSELECT DAY(DT) AS Days,\nSUM(COALESCE(EDC_GMV,0)) AS TOTAL_GMV,\nSUM(case when final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS CC_GMV,\nSUM(case when final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS DC_GMV,\nSUM(case when final_payment_mode = 'EMI' THEN  COALESCE(EDC_GMV,0) END) AS EMI_GMV,\nSUM(case when final_payment_mode = 'UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS UPI_CC_GMV,\nSUM(case when final_payment_mode = 'UPI' THEN  COALESCE(EDC_GMV,0) END) AS UPI_GMV,\nSUM(case when final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS CS70_UPI_CC_GMV,\nSUM(case when final_payment_mode = 'CS70_UPI' THEN  COALESCE(EDC_GMV,0) END) AS CS70_UPI_GMV,\nSUM(case when final_payment_mode = 'OTHERS' THEN  COALESCE(EDC_GMV,0) END) AS REST_GMV,\nSUM(COALESCE(MDR,0)) AS TOTAL_REVENUE,\nSUM(case when final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(MDR,0) END) AS CC_MDR,\nSUM(case when final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(MDR,0) END) AS DC_MDR,\nSUM(case when final_payment_mode = 'EMI' THEN  COALESCE(MDR,0) END) AS EMI_MDR,\nSUM(case when final_payment_mode = 'UPI_CC' THEN  COALESCE(MDR,0) END) AS UPI_CC_MDR,\nSUM(case when final_payment_mode = 'UPI' THEN  COALESCE(MDR,0) END) AS UPI_MDR,\nSUM(case when final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(MDR,0) END) AS CS70_UPI_CC_MDR,\nSUM(case when final_payment_mode = 'CS70_UPI' THEN  COALESCE(MDR,0) END) AS CS70_UPI_MDR,\nSUM(CASE WHEN POSPROVIDER_FLAG = 'AGG' THEN COALESCE(EDC_GMV,0) END) AS AGG_GMV,\nSUM(CASE WHEN POSPROVIDER_FLAG = 'AGG' AND FINAL_PAYMENT_MODE NOT IN ('UPI','CS70_UPI') THEN COALESCE(EDC_GMV,0) END) AS AGG_GMV_EXCLUDING_UPI,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS AGG_CC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(EDC_GMV,0) END) AS AGG_DC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'EMI' THEN  COALESCE(EDC_GMV,0) END) AS AGG_EMI_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS AGG_UPI_CC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'UPI' THEN  COALESCE(EDC_GMV,0) END) AS AGG_UPI_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(EDC_GMV,0) END) AS AGG_CS70_UPI_CC_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'CS70_UPI' THEN  COALESCE(EDC_GMV,0) END) AS AGG_CS70_UPI_GMV,\nSUM(case when POSPROVIDER_FLAG = 'AGG' AND final_payment_mode = 'OTHERS' THEN  COALESCE(EDC_GMV,0) END) AS AGG_REST_GMV\nFROM CTE\nGROUP BY 1\nORDER BY  DAYS\n) AS virtual_table GROUP BY \"Days\" ORDER BY \"Total GMV(in Cr)\" DESC\nLIMIT 1000;\n\n",
      "metrics": [
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Total GMV(in Cr)",
          "optionName": "metric_uqoqdqcuk1_h1fn037h6fa",
          "sqlExpression": "SUM(TOTAL_GMV)/1e7"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "CARD_GMV",
          "optionName": "metric_5pef2ulkda9_ii1eofb0w",
          "sqlExpression": "SUM((CC_GMV)+(DC_GMV)+(EMI_GMV)+(UPI_CC_GMV)+(CS70_UPI_CC_GMV))/1e7"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Chargeable GMV (in Cr)",
          "optionName": "metric_518i7vahxkr_6d26incdow3",
          "sqlExpression": "SUM(AGG_GMV_EXCLUDING_UPI)/1e7"
        },
        {
          "aggregate": null,
          "column": null,
          "datasourceWarning": false,
          "expressionType": "SQL",
          "hasCustomLabel": true,
          "label": "Chargeable %",
          "optionName": "metric_ejddo8xbh_qnlriqnfmil",
          "sqlExpression": "((SUM(AGG_GMV_EXCLUDING_UPI)) / (SUM(CC_GMV+DC_GMV+EMI_GMV+UPI_CC_GMV+CS70_UPI_CC_GMV)))*100"
        }
      ],
      "columns": [
        "Days",
        "TOTAL_GMV",
        "CC_GMV",
        "DC_GMV",
        "EMI_GMV",
        "UPI_CC_GMV",
        "UPI_GMV",
        "CS70_UPI_CC_GMV",
        "CS70_UPI_GMV",
        "REST_GMV",
        "TOTAL_REVENUE",
        "CC_MDR",
        "DC_MDR",
        "EMI_MDR",
        "UPI_CC_MDR",
        "UPI_MDR",
        "CS70_UPI_CC_MDR",
        "CS70_UPI_MDR",
        "AGG_GMV",
        "AGG_GMV_EXCLUDING_UPI",
        "AGG_CC_GMV",
        "AGG_DC_GMV",
        "AGG_EMI_GMV",
        "AGG_UPI_CC_GMV",
        "AGG_UPI_GMV",
        "AGG_CS70_UPI_CC_GMV",
        "AGG_CS70_UPI_GMV",
        "AGG_REST_GMV"
      ],
      "groupby_columns": [],
      "filters": [],
      "time_range": null
    }
  ]
}