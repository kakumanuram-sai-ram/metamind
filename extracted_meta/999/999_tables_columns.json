[
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"device_serial_no",
    "alias_column_name":"device_serial_no",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"dl_last_updated",
    "alias_column_name":"dl_last_updated",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"dt",
    "alias_column_name":"Days",
    "source_or_derived":"derived",
    "derived_column_logic":"DAY(DT)"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"dt",
    "alias_column_name":"dt",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"final_emitype",
    "alias_column_name":"final_emitype",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"AGG_GMV_EXCLUDING_UPI",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(CASE WHEN POSPROVIDER_FLAG = 'AGG' AND FINAL_PAYMENT_MODE NOT IN ('UPI','CS70_UPI') THEN COALESCE(EDC_GMV,0) END)"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"CARD_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM((CC_GMV)+(DC_GMV)+(EMI_GMV)+(UPI_CC_GMV)+(CS70_UPI_CC_GMV))\/1e7"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"CC_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(case when final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(EDC_GMV,0) END)"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"CS70_UPI_CC_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(case when final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(EDC_GMV,0) END)"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"Chargeable %",
    "source_or_derived":"derived",
    "derived_column_logic":"((SUM(AGG_GMV_EXCLUDING_UPI)) \/ (SUM(CC_GMV+DC_GMV+EMI_GMV+UPI_CC_GMV+CS70_UPI_CC_GMV)))*100"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"Chargeable GMV (in Cr)",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(AGG_GMV_EXCLUDING_UPI)\/1e7"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"DC_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(case when final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(EDC_GMV,0) END)"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"EDC_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"sum(gtv + coalesce(gtv_ad,0))"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"EMI_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(case when final_payment_mode = 'EMI' THEN  COALESCE(EDC_GMV,0) END)"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"TOTAL_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(COALESCE(EDC_GMV,0))"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"Total GMV(in Cr)",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(TOTAL_GMV)\/1e7"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"UPI_CC_GMV",
    "source_or_derived":"derived",
    "derived_column_logic":"SUM(case when final_payment_mode = 'UPI_CC' THEN  COALESCE(EDC_GMV,0) END)"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"gtv",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"gtv_ad",
    "alias_column_name":"gtv_ad",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"mid",
    "alias_column_name":"mid",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"payment_mode",
    "alias_column_name":"payment_mode",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"pg_comm",
    "alias_column_name":"mdr",
    "source_or_derived":"derived",
    "derived_column_logic":"sum(pg_comm+coalesce(pg_comm_ad,0))"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"pg_comm",
    "alias_column_name":"pg_comm",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"pg_comm_ad",
    "alias_column_name":"pg_comm_ad",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"requesttype",
    "alias_column_name":"Final_payment_mode",
    "source_or_derived":"derived",
    "derived_column_logic":"case when lower(requesttype) = 'edc' and lower(payment_mode) = 'credit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'CREDIT_CARD' when lower(requesttype) = 'edc' and lower(payment_mode) = 'debit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'DEBIT_CARD' when final_emitype  in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') then'EMI' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'UPI_CC' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'UPI' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'CS70_UPI_CC' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'CS70_UPI' ELSE 'OTHERS' END"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"requesttype",
    "alias_column_name":"requesttype",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"transaction_bank_settled",
    "alias_column_name":"POSPROVIDER_FLAG",
    "source_or_derived":"derived",
    "derived_column_logic":"CASE WHEN UPPER(COALESCE(transaction_bank_settled,'FALSE')) IN ('TRUE') THEN 'POS' ELSE 'AGG' END"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"transaction_bank_settled",
    "alias_column_name":"transaction_bank_settled",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"txn",
    "alias_column_name":"txn",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.business_edc_txn_base_snapshot_v3",
    "column_names":"upi_sub_type",
    "alias_column_name":"upi_sub_type",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"device_serial_no",
    "alias_column_name":"device_serial_no",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"dl_last_updated",
    "alias_column_name":"dl_last_updated",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"dt",
    "alias_column_name":"dt",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"final_emitype",
    "alias_column_name":"final_emitype",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"gtv",
    "alias_column_name":"gtv",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"gtv_ad",
    "alias_column_name":"gtv_ad",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"mid",
    "alias_column_name":"mid",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"payment_mode",
    "alias_column_name":"payment_mode",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"pg_comm",
    "alias_column_name":"pg_comm",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"pg_comm_ad",
    "alias_column_name":"pg_comm_ad",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"requesttype",
    "alias_column_name":"requesttype",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"transaction_bank_settled",
    "alias_column_name":"transaction_bank_settled",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"txn",
    "alias_column_name":"txn",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.cdo.edc_final_business_base_snapshot_v3",
    "column_names":"upi_sub_type",
    "alias_column_name":"upi_sub_type",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"device_serial_no",
    "alias_column_name":"device_serial_no",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"dl_last_updated",
    "alias_column_name":"dl_last_updated",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"dt",
    "alias_column_name":"dt",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"final_emitype",
    "alias_column_name":"final_emitype",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"gtv",
    "alias_column_name":"gtv",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"gtv_ad",
    "alias_column_name":"gtv_ad",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"mid",
    "alias_column_name":"mid",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"payment_mode",
    "alias_column_name":"payment_mode",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"pg_comm",
    "alias_column_name":"pg_comm",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"pg_comm_ad",
    "alias_column_name":"pg_comm_ad",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"requesttype",
    "alias_column_name":"requesttype",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"transaction_bank_settled",
    "alias_column_name":"transaction_bank_settled",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"txn",
    "alias_column_name":"txn",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  },
  {
    "tables_involved":"hive.user_paytm_payments.offline_channel_mapping_for_ra",
    "column_names":"upi_sub_type",
    "alias_column_name":"upi_sub_type",
    "source_or_derived":"source",
    "derived_column_logic":"NA"
  }
]