tables_involved,column_names,alias_column_name,source_or_derived,derived_column_logic,column_datatype,extra,comment
hive.cdo.business_edc_txn_base_snapshot_v3,device_serial_no,device_serial_no,source,,varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,dl_last_updated,dl_last_updated,source,,date,,
hive.cdo.business_edc_txn_base_snapshot_v3,dt,Days,derived,DAY(DT),date,,
hive.cdo.business_edc_txn_base_snapshot_v3,dt,dt,source,,date,,
hive.cdo.business_edc_txn_base_snapshot_v3,final_emitype,final_emitype,source,,varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,AGG_GMV_EXCLUDING_UPI,derived,"SUM(CASE WHEN POSPROVIDER_FLAG = 'AGG' AND FINAL_PAYMENT_MODE NOT IN ('UPI','CS70_UPI') THEN COALESCE(EDC_GMV,0) END)",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,CARD_GMV,derived,SUM((CC_GMV)+(DC_GMV)+(EMI_GMV)+(UPI_CC_GMV)+(CS70_UPI_CC_GMV))/1e7,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,CC_GMV,derived,"SUM(case when final_payment_mode = 'CREDIT_CARD' THEN  COALESCE(EDC_GMV,0) END)",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,CS70_UPI_CC_GMV,derived,"SUM(case when final_payment_mode = 'CS70_UPI_CC' THEN  COALESCE(EDC_GMV,0) END)",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,Chargeable %,derived,((SUM(AGG_GMV_EXCLUDING_UPI)) / (SUM(CC_GMV+DC_GMV+EMI_GMV+UPI_CC_GMV+CS70_UPI_CC_GMV)))*100,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,Chargeable GMV (in Cr),derived,SUM(AGG_GMV_EXCLUDING_UPI)/1e7,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,DC_GMV,derived,"SUM(case when final_payment_mode = 'DEBIT_CARD' THEN  COALESCE(EDC_GMV,0) END)",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,EDC_GMV,derived,"sum(gtv + coalesce(gtv_ad,0))",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,EMI_GMV,derived,"SUM(case when final_payment_mode = 'EMI' THEN  COALESCE(EDC_GMV,0) END)",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,TOTAL_GMV,derived,"SUM(COALESCE(EDC_GMV,0))",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,Total GMV(in Cr),derived,SUM(TOTAL_GMV)/1e7,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,UPI_CC_GMV,derived,"SUM(case when final_payment_mode = 'UPI_CC' THEN  COALESCE(EDC_GMV,0) END)",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv,gtv,source,,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,gtv_ad,gtv_ad,source,,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,mid,mid,source,,varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,payment_mode,payment_mode,source,,varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,pg_comm,mdr,derived,"sum(pg_comm+coalesce(pg_comm_ad,0))",double,,
hive.cdo.business_edc_txn_base_snapshot_v3,pg_comm,pg_comm,source,,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,pg_comm_ad,pg_comm_ad,source,,double,,
hive.cdo.business_edc_txn_base_snapshot_v3,requesttype,Final_payment_mode,derived,"case when lower(requesttype) = 'edc' and lower(payment_mode) = 'credit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'CREDIT_CARD' when lower(requesttype) = 'edc' and lower(payment_mode) = 'debit_card' and final_emitype not in ('Brand EMI full swipe','Bank_full_swipe_EMI')  then 'DEBIT_CARD' when final_emitype  in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') then'EMI' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'UPI_CC' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'DYNAMIC_QR' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'UPI' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND upi_sub_type = 'UPI_CREDIT_CARD' then 'CS70_UPI_CC' when final_emitype  not in ('Brand EMI','Brand EMI full swipe','Bank_EMI','Bank_full_swipe_EMI') and payment_mode = 'UPI' AND requesttype = 'SEAMLESS_3D_FORM' AND COALESCE(upi_sub_type,'OTHERS') NOT IN ('UPI_CREDIT_CARD') then 'CS70_UPI' ELSE 'OTHERS' END",varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,requesttype,requesttype,source,,varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,transaction_bank_settled,POSPROVIDER_FLAG,derived,"CASE WHEN UPPER(COALESCE(transaction_bank_settled,'FALSE')) IN ('TRUE') THEN 'POS' ELSE 'AGG' END",varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,transaction_bank_settled,transaction_bank_settled,source,,varchar,,
hive.cdo.business_edc_txn_base_snapshot_v3,txn,txn,source,,bigint,,
hive.cdo.business_edc_txn_base_snapshot_v3,upi_sub_type,upi_sub_type,source,,varchar,,
hive.cdo.edc_final_business_base_snapshot_v3,device_serial_no,device_serial_no,source,,varchar,,
hive.cdo.edc_final_business_base_snapshot_v3,dl_last_updated,dl_last_updated,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,dt,dt,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,final_emitype,final_emitype,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,gtv,gtv,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,gtv_ad,gtv_ad,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,mid,mid,source,,varchar,,
hive.cdo.edc_final_business_base_snapshot_v3,payment_mode,payment_mode,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,pg_comm,pg_comm,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,pg_comm_ad,pg_comm_ad,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,requesttype,requesttype,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,transaction_bank_settled,transaction_bank_settled,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,txn,txn,source,,,,
hive.cdo.edc_final_business_base_snapshot_v3,upi_sub_type,upi_sub_type,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,device_serial_no,device_serial_no,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,dl_last_updated,dl_last_updated,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,dt,dt,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,final_emitype,final_emitype,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,gtv,gtv,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,gtv_ad,gtv_ad,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,mid,mid,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,payment_mode,payment_mode,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,pg_comm,pg_comm,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,pg_comm_ad,pg_comm_ad,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,requesttype,requesttype,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,transaction_bank_settled,transaction_bank_settled,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,txn,txn,source,,,,
hive.user_paytm_payments.offline_channel_mapping_for_ra,upi_sub_type,upi_sub_type,source,,,,
